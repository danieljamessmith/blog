<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Smith">
<meta name="dcterms.date" content="2024-01-22">

<title>djs - Portfolio - Charge-Off Prediction With a Neural Network</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">djs - Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Charge-Off Prediction With a Neural Network</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Pandas</div>
    <div class="quarto-category">TensorFlow</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Smith </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="imports" class="level1">
<h1>IMPORTS</h1>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">—-</h2>
<p>There are many LendingClub data sets on Kaggle. Here is the information on this particular data set:</p>
<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
LoanStatNew
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
loan_amnt
</td>
<td>
The listed amount of the loan applied for by the borrower. If at some point in time, the credit department reduces the loan amount, then it will be reflected in this value.
</td>
</tr>
<tr>
<th>
1
</th>
<td>
term
</td>
<td>
The number of payments on the loan. Values are in months and can be either 36 or 60.
</td>
</tr>
<tr>
<th>
2
</th>
<td>
int_rate
</td>
<td>
Interest Rate on the loan
</td>
</tr>
<tr>
<th>
3
</th>
<td>
installment
</td>
<td>
The monthly payment owed by the borrower if the loan originates.
</td>
</tr>
<tr>
<th>
4
</th>
<td>
grade
</td>
<td>
LC assigned loan grade
</td>
</tr>
<tr>
<th>
5
</th>
<td>
sub_grade
</td>
<td>
LC assigned loan subgrade
</td>
</tr>
<tr>
<th>
6
</th>
<td>
emp_title
</td>
<td>
The job title supplied by the Borrower when applying for the loan.*
</td>
</tr>
<tr>
<th>
7
</th>
<td>
emp_length
</td>
<td>
Employment length in years. Possible values are between 0 and 10 where 0 means less than one year and 10 means ten or more years.
</td>
</tr>
<tr>
<th>
8
</th>
<td>
home_ownership
</td>
<td>
The home ownership status provided by the borrower during registration&nbsp;or obtained from the credit report.&nbsp;Our values are: RENT, OWN, MORTGAGE, OTHER
</td>
</tr>
<tr>
<th>
9
</th>
<td>
annual_inc
</td>
<td>
The self-reported annual income provided by the borrower during registration.
</td>
</tr>
<tr>
<th>
10
</th>
<td>
verification_status
</td>
<td>
Indicates if income was verified by LC, not verified, or if the income source was verified
</td>
</tr>
<tr>
<th>
11
</th>
<td>
issue_d
</td>
<td>
The month which the loan was funded
</td>
</tr>
<tr>
<th>
12
</th>
<td>
loan_status
</td>
<td>
Current status of the loan
</td>
</tr>
<tr>
<th>
13
</th>
<td>
purpose
</td>
<td>
A category provided by the borrower for the loan request.
</td>
</tr>
<tr>
<th>
14
</th>
<td>
title
</td>
<td>
The loan title provided by the borrower
</td>
</tr>
<tr>
<th>
15
</th>
<td>
zip_code
</td>
<td>
The first 3 numbers of the zip code provided by the borrower in the loan application.
</td>
</tr>
<tr>
<th>
16
</th>
<td>
addr_state
</td>
<td>
The state provided by the borrower in the loan application
</td>
</tr>
<tr>
<th>
17
</th>
<td>
dti
</td>
<td>
A ratio calculated using the borrower’s total monthly debt payments on the total debt obligations, excluding mortgage and the requested LC loan, divided by the borrower’s self-reported monthly income.
</td>
</tr>
<tr>
<th>
18
</th>
<td>
earliest_cr_line
</td>
<td>
The month the borrower’s earliest reported credit line was opened
</td>
</tr>
<tr>
<th>
19
</th>
<td>
open_acc
</td>
<td>
The number of open credit lines in the borrower’s credit file.
</td>
</tr>
<tr>
<th>
20
</th>
<td>
pub_rec
</td>
<td>
Number of derogatory public records
</td>
</tr>
<tr>
<th>
21
</th>
<td>
revol_bal
</td>
<td>
Total credit revolving balance
</td>
</tr>
<tr>
<th>
22
</th>
<td>
revol_util
</td>
<td>
Revolving line utilization rate, or the amount of credit the borrower is using relative to all available revolving credit.
</td>
</tr>
<tr>
<th>
23
</th>
<td>
total_acc
</td>
<td>
The total number of credit lines currently in the borrower’s credit file
</td>
</tr>
<tr>
<th>
24
</th>
<td>
initial_list_status
</td>
<td>
The initial listing status of the loan. Possible values are – W, F
</td>
</tr>
<tr>
<th>
25
</th>
<td>
application_type
</td>
<td>
Indicates whether the loan is an individual application or a joint application with two co-borrowers
</td>
</tr>
<tr>
<th>
26
</th>
<td>
mort_acc
</td>
<td>
Number of mortgage accounts.
</td>
</tr>
<tr>
<th>
27
</th>
<td>
pub_rec_bankruptcies
</td>
<td>
Number of public record bankruptcies
</td>
</tr>
</tbody>
</table>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">—</h2>
<div id="cell-3" class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visulisation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sklearn</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils.class_weight <span class="im">import</span> compute_class_weight</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Dropout, LeakyReLU</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'lending_club_loan.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 396030 entries, 0 to 396029
Data columns (total 27 columns):
 #   Column                Non-Null Count   Dtype  
---  ------                --------------   -----  
 0   loan_amnt             396030 non-null  float64
 1   term                  396030 non-null  object 
 2   int_rate              396030 non-null  float64
 3   installment           396030 non-null  float64
 4   grade                 396030 non-null  object 
 5   sub_grade             396030 non-null  object 
 6   emp_title             373103 non-null  object 
 7   emp_length            377729 non-null  object 
 8   home_ownership        396030 non-null  object 
 9   annual_inc            396030 non-null  float64
 10  verification_status   396030 non-null  object 
 11  issue_d               396030 non-null  object 
 12  loan_status           396030 non-null  object 
 13  purpose               396030 non-null  object 
 14  title                 394274 non-null  object 
 15  dti                   396030 non-null  float64
 16  earliest_cr_line      396030 non-null  object 
 17  open_acc              396030 non-null  float64
 18  pub_rec               396030 non-null  float64
 19  revol_bal             396030 non-null  float64
 20  revol_util            395754 non-null  float64
 21  total_acc             396030 non-null  float64
 22  initial_list_status   396030 non-null  object 
 23  application_type      396030 non-null  object 
 24  mort_acc              358235 non-null  float64
 25  pub_rec_bankruptcies  395495 non-null  float64
 26  address               396030 non-null  object 
dtypes: float64(12), object(15)
memory usage: 81.6+ MB</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">installment</th>
<th data-quarto-table-cell-role="th">grade</th>
<th data-quarto-table-cell-role="th">sub_grade</th>
<th data-quarto-table-cell-role="th">emp_title</th>
<th data-quarto-table-cell-role="th">emp_length</th>
<th data-quarto-table-cell-role="th">home_ownership</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">open_acc</th>
<th data-quarto-table-cell-role="th">pub_rec</th>
<th data-quarto-table-cell-role="th">revol_bal</th>
<th data-quarto-table-cell-role="th">revol_util</th>
<th data-quarto-table-cell-role="th">total_acc</th>
<th data-quarto-table-cell-role="th">initial_list_status</th>
<th data-quarto-table-cell-role="th">application_type</th>
<th data-quarto-table-cell-role="th">mort_acc</th>
<th data-quarto-table-cell-role="th">pub_rec_bankruptcies</th>
<th data-quarto-table-cell-role="th">address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10000.0</td>
<td>36 months</td>
<td>11.44</td>
<td>329.48</td>
<td>B</td>
<td>B4</td>
<td>Marketing</td>
<td>10+ years</td>
<td>RENT</td>
<td>117000.0</td>
<td>...</td>
<td>16.0</td>
<td>0.0</td>
<td>36369.0</td>
<td>41.8</td>
<td>25.0</td>
<td>w</td>
<td>INDIVIDUAL</td>
<td>0.0</td>
<td>0.0</td>
<td>0174 Michelle Gateway\nMendozaberg, OK 22690</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8000.0</td>
<td>36 months</td>
<td>11.99</td>
<td>265.68</td>
<td>B</td>
<td>B5</td>
<td>Credit analyst</td>
<td>4 years</td>
<td>MORTGAGE</td>
<td>65000.0</td>
<td>...</td>
<td>17.0</td>
<td>0.0</td>
<td>20131.0</td>
<td>53.3</td>
<td>27.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>3.0</td>
<td>0.0</td>
<td>1076 Carney Fort Apt. 347\nLoganmouth, SD 05113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>15600.0</td>
<td>36 months</td>
<td>10.49</td>
<td>506.97</td>
<td>B</td>
<td>B3</td>
<td>Statistician</td>
<td>&lt; 1 year</td>
<td>RENT</td>
<td>43057.0</td>
<td>...</td>
<td>13.0</td>
<td>0.0</td>
<td>11987.0</td>
<td>92.2</td>
<td>26.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>0.0</td>
<td>0.0</td>
<td>87025 Mark Dale Apt. 269\nNew Sabrina, WV 05113</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7200.0</td>
<td>36 months</td>
<td>6.49</td>
<td>220.65</td>
<td>A</td>
<td>A2</td>
<td>Client Advocate</td>
<td>6 years</td>
<td>RENT</td>
<td>54000.0</td>
<td>...</td>
<td>6.0</td>
<td>0.0</td>
<td>5472.0</td>
<td>21.5</td>
<td>13.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>0.0</td>
<td>0.0</td>
<td>823 Reid Ford\nDelacruzside, MA 00813</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24375.0</td>
<td>60 months</td>
<td>17.27</td>
<td>609.33</td>
<td>C</td>
<td>C5</td>
<td>Destiny Management Inc.</td>
<td>9 years</td>
<td>MORTGAGE</td>
<td>55000.0</td>
<td>...</td>
<td>13.0</td>
<td>0.0</td>
<td>24584.0</td>
<td>69.8</td>
<td>43.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>1.0</td>
<td>0.0</td>
<td>679 Luna Roads\nGreggshire, VA 11650</td>
</tr>
</tbody>
</table>

<p>5 rows × 27 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>EXPLORATORY DATA ANALYSIS</h1>
<div id="cell-8" class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'loan_status'</span>,data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-9" class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sns.displot(df[<span class="st">'loan_amnt'</span>],kde<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-10" class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">installment</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">dti</th>
<th data-quarto-table-cell-role="th">open_acc</th>
<th data-quarto-table-cell-role="th">pub_rec</th>
<th data-quarto-table-cell-role="th">revol_bal</th>
<th data-quarto-table-cell-role="th">revol_util</th>
<th data-quarto-table-cell-role="th">total_acc</th>
<th data-quarto-table-cell-role="th">mort_acc</th>
<th data-quarto-table-cell-role="th">pub_rec_bankruptcies</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">loan_amnt</td>
<td>1.000000</td>
<td>0.168921</td>
<td>0.953929</td>
<td>0.336887</td>
<td>0.016636</td>
<td>0.198556</td>
<td>-0.077779</td>
<td>0.328320</td>
<td>0.099911</td>
<td>0.223886</td>
<td>0.222315</td>
<td>-0.106539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">int_rate</td>
<td>0.168921</td>
<td>1.000000</td>
<td>0.162758</td>
<td>-0.056771</td>
<td>0.079038</td>
<td>0.011649</td>
<td>0.060986</td>
<td>-0.011280</td>
<td>0.293659</td>
<td>-0.036404</td>
<td>-0.082583</td>
<td>0.057450</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">installment</td>
<td>0.953929</td>
<td>0.162758</td>
<td>1.000000</td>
<td>0.330381</td>
<td>0.015786</td>
<td>0.188973</td>
<td>-0.067892</td>
<td>0.316455</td>
<td>0.123915</td>
<td>0.202430</td>
<td>0.193694</td>
<td>-0.098628</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">annual_inc</td>
<td>0.336887</td>
<td>-0.056771</td>
<td>0.330381</td>
<td>1.000000</td>
<td>-0.081685</td>
<td>0.136150</td>
<td>-0.013720</td>
<td>0.299773</td>
<td>0.027871</td>
<td>0.193023</td>
<td>0.236320</td>
<td>-0.050162</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dti</td>
<td>0.016636</td>
<td>0.079038</td>
<td>0.015786</td>
<td>-0.081685</td>
<td>1.000000</td>
<td>0.136181</td>
<td>-0.017639</td>
<td>0.063571</td>
<td>0.088375</td>
<td>0.102128</td>
<td>-0.025439</td>
<td>-0.014558</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">open_acc</td>
<td>0.198556</td>
<td>0.011649</td>
<td>0.188973</td>
<td>0.136150</td>
<td>0.136181</td>
<td>1.000000</td>
<td>-0.018392</td>
<td>0.221192</td>
<td>-0.131420</td>
<td>0.680728</td>
<td>0.109205</td>
<td>-0.027732</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">pub_rec</td>
<td>-0.077779</td>
<td>0.060986</td>
<td>-0.067892</td>
<td>-0.013720</td>
<td>-0.017639</td>
<td>-0.018392</td>
<td>1.000000</td>
<td>-0.101664</td>
<td>-0.075910</td>
<td>0.019723</td>
<td>0.011552</td>
<td>0.699408</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">revol_bal</td>
<td>0.328320</td>
<td>-0.011280</td>
<td>0.316455</td>
<td>0.299773</td>
<td>0.063571</td>
<td>0.221192</td>
<td>-0.101664</td>
<td>1.000000</td>
<td>0.226346</td>
<td>0.191616</td>
<td>0.194925</td>
<td>-0.124532</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">revol_util</td>
<td>0.099911</td>
<td>0.293659</td>
<td>0.123915</td>
<td>0.027871</td>
<td>0.088375</td>
<td>-0.131420</td>
<td>-0.075910</td>
<td>0.226346</td>
<td>1.000000</td>
<td>-0.104273</td>
<td>0.007514</td>
<td>-0.086751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">total_acc</td>
<td>0.223886</td>
<td>-0.036404</td>
<td>0.202430</td>
<td>0.193023</td>
<td>0.102128</td>
<td>0.680728</td>
<td>0.019723</td>
<td>0.191616</td>
<td>-0.104273</td>
<td>1.000000</td>
<td>0.381072</td>
<td>0.042035</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mort_acc</td>
<td>0.222315</td>
<td>-0.082583</td>
<td>0.193694</td>
<td>0.236320</td>
<td>-0.025439</td>
<td>0.109205</td>
<td>0.011552</td>
<td>0.194925</td>
<td>0.007514</td>
<td>0.381072</td>
<td>1.000000</td>
<td>0.027239</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">pub_rec_bankruptcies</td>
<td>-0.106539</td>
<td>0.057450</td>
<td>-0.098628</td>
<td>-0.050162</td>
<td>-0.014558</td>
<td>-0.027732</td>
<td>0.699408</td>
<td>-0.124532</td>
<td>-0.086751</td>
<td>0.042035</td>
<td>0.027239</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-11" class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">7</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(numeric_only<span class="op">=</span><span class="va">True</span>),annot<span class="op">=</span><span class="va">True</span>,cmap<span class="op">=</span><span class="st">'viridis'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-12" class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'installment'</span>,y<span class="op">=</span><span class="st">'loan_amnt'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-13" class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'loan_status'</span>,y<span class="op">=</span><span class="st">'loan_amnt'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-14" class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'loan_status'</span>)[<span class="st">'loan_amnt'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">loan_status</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Charged Off</td>
<td>77673.0</td>
<td>15126.300967</td>
<td>8505.090557</td>
<td>1000.0</td>
<td>8525.0</td>
<td>14000.0</td>
<td>20000.0</td>
<td>40000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Fully Paid</td>
<td>318357.0</td>
<td>13866.878771</td>
<td>8302.319699</td>
<td>500.0</td>
<td>7500.0</td>
<td>12000.0</td>
<td>19225.0</td>
<td>40000.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-15" class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'grade'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array(['B', 'A', 'C', 'E', 'D', 'F', 'G'], dtype=object)</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'sub_grade'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array(['B4', 'B5', 'B3', 'A2', 'C5', 'C3', 'A1', 'B2', 'C1', 'A5', 'E4',
       'A4', 'A3', 'D1', 'C2', 'B1', 'D3', 'D5', 'D2', 'E1', 'E2', 'E5',
       'F4', 'E3', 'D4', 'G1', 'F5', 'G2', 'C4', 'F1', 'F3', 'G5', 'G4',
       'F2', 'G3'], dtype=object)</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'grade'</span>,hue<span class="op">=</span><span class="st">'loan_status'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-18" class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>subgrade_order <span class="op">=</span> <span class="bu">sorted</span>(df[<span class="st">'sub_grade'</span>].unique())</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'sub_grade'</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>subgrade_order,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span><span class="st">'coolwarm'</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'loan_status'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-19" class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>f_g <span class="op">=</span> df[(df[<span class="st">'grade'</span>] <span class="op">==</span> <span class="st">'G'</span>) <span class="op">|</span> (df[<span class="st">'grade'</span>] <span class="op">==</span> <span class="st">'F'</span>)]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>subgrade_order <span class="op">=</span> <span class="bu">sorted</span>(f_g[<span class="st">'sub_grade'</span>].unique())</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>f_g,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'sub_grade'</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>subgrade_order,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span><span class="st">'coolwarm'</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'loan_status'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="missing-values-and-feature-engineering" class="level1">
<h1>MISSING VALUES AND FEATURE ENGINEERING</h1>
<div id="cell-21" class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'loan_repaid'</span>] <span class="op">=</span> (df[<span class="st">'loan_status'</span>] <span class="op">==</span> <span class="st">'Fully Paid'</span>).astype(<span class="bu">int</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'loan_repaid'</span>,<span class="st">'loan_status'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_repaid</th>
<th data-quarto-table-cell-role="th">loan_status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>Charged Off</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396025</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396026</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396027</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396028</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396029</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
</tbody>
</table>

<p>396030 rows × 2 columns</p>
</div>
</div>
</div>
<div id="cell-22" class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'loan_repaid'</span>].sort_values().drop(<span class="st">'loan_repaid'</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-23" class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>loan_amnt                   0
term                        0
int_rate                    0
installment                 0
grade                       0
sub_grade                   0
emp_title               22927
emp_length              18301
home_ownership              0
annual_inc                  0
verification_status         0
issue_d                     0
loan_status                 0
purpose                     0
title                    1756
dti                         0
earliest_cr_line            0
open_acc                    0
pub_rec                     0
revol_bal                   0
revol_util                276
total_acc                   0
initial_list_status         0
application_type            0
mort_acc                37795
pub_rec_bankruptcies      535
address                     0
loan_repaid                 0
dtype: int64</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> percentage_null(df):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    percentage_missing <span class="op">=</span> (df.isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(df))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Percentages of values missing:</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(percentage_missing.<span class="bu">round</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.00
term                    0.00
int_rate                0.00
installment             0.00
grade                   0.00
sub_grade               0.00
emp_title               5.79
emp_length              4.62
home_ownership          0.00
annual_inc              0.00
verification_status     0.00
issue_d                 0.00
loan_status             0.00
purpose                 0.00
title                   0.44
dti                     0.00
earliest_cr_line        0.00
open_acc                0.00
pub_rec                 0.00
revol_bal               0.00
revol_util              0.07
total_acc               0.00
initial_list_status     0.00
application_type        0.00
mort_acc                9.54
pub_rec_bankruptcies    0.14
address                 0.00
loan_repaid             0.00
dtype: float64</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'title'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0                        Vacation
1              Debt consolidation
2         Credit card refinancing
3         Credit card refinancing
4           Credit Card Refinance
                   ...           
396025         Debt consolidation
396026         Debt consolidation
396027       pay off credit cards
396028              Loanforpayoff
396029          Toxic Debt Payoff
Name: title, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'purpose'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0                   vacation
1         debt_consolidation
2                credit_card
3                credit_card
4                credit_card
                 ...        
396025    debt_consolidation
396026    debt_consolidation
396027    debt_consolidation
396028    debt_consolidation
396029    debt_consolidation
Name: purpose, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div id="cell-28" class="cell" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">'title'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="emp_title-and-emp_length" class="level2">
<h2 class="anchored" data-anchor-id="emp_title-and-emp_length"><code>emp_title</code> and <code>emp_length</code></h2>
<div id="cell-30" class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'emp_title'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0                        Marketing
1                  Credit analyst 
2                     Statistician
3                  Client Advocate
4          Destiny Management Inc.
                    ...           
396025            licensed bankere
396026                       Agent
396027                City Carrier
396028        Gracon Services, Inc
396029    Internal Revenue Service
Name: emp_title, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-tags="[]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'emp_title'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>173105</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">'emp_title'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-33" class="cell" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'emp_length'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0         10+ years
1           4 years
2          &lt; 1 year
3           6 years
4           9 years
            ...    
396025      2 years
396026      5 years
396027    10+ years
396028    10+ years
396029    10+ years
Name: emp_length, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-tags="[]" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>(df[<span class="st">'emp_length'</span>].dropna().unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>['1 year',
 '10+ years',
 '2 years',
 '3 years',
 '4 years',
 '5 years',
 '6 years',
 '7 years',
 '8 years',
 '9 years',
 '&lt; 1 year']</code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-tags="[]" data-execution_count="30">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ordered_emp_lengths <span class="op">=</span> [<span class="st">'&lt; 1 year'</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'1 year'</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'2 years'</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'3 years'</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'4 years'</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'5 years'</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'6 years'</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'7 years'</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'8 years'</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'9 years'</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'10+ years'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-36" class="cell" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">5</span>))</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'emp_length'</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>ordered_emp_lengths,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span><span class="st">'viridis'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-37" class="cell" data-tags="[]" data-execution_count="32">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">5</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'emp_length'</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>ordered_emp_lengths,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'loan_repaid'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-38" class="cell" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>emp_co <span class="op">=</span> df[df[<span class="st">'loan_repaid'</span>] <span class="op">==</span> <span class="dv">0</span>].groupby(<span class="st">'emp_length'</span>).count()[<span class="st">'loan_repaid'</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>emp_fp <span class="op">=</span> df[df[<span class="st">'loan_repaid'</span>] <span class="op">==</span> <span class="dv">1</span>].groupby(<span class="st">'emp_length'</span>).count()[<span class="st">'loan_repaid'</span>]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">2</span>))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>((emp_co<span class="op">/</span>(emp_fp<span class="op">+</span>emp_co))<span class="op">*</span><span class="dv">100</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-39" class="cell" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">'emp_length'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filling-mort_acc-using-total_acc" class="level2">
<h2 class="anchored" data-anchor-id="filling-mort_acc-using-total_acc">Filling <code>mort_acc</code> using <code>total_acc</code></h2>
<div id="cell-41" class="cell" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.00
term                    0.00
int_rate                0.00
installment             0.00
grade                   0.00
sub_grade               0.00
home_ownership          0.00
annual_inc              0.00
verification_status     0.00
issue_d                 0.00
loan_status             0.00
purpose                 0.00
dti                     0.00
earliest_cr_line        0.00
open_acc                0.00
pub_rec                 0.00
revol_bal               0.00
revol_util              0.07
total_acc               0.00
initial_list_status     0.00
application_type        0.00
mort_acc                9.54
pub_rec_bankruptcies    0.14
address                 0.00
loan_repaid             0.00
dtype: float64</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-tags="[]" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mort_acc'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>mort_acc
0.0     139777
1.0      60416
2.0      49948
3.0      38049
4.0      27887
5.0      18194
6.0      11069
7.0       6052
8.0       3121
9.0       1656
10.0       865
11.0       479
12.0       264
13.0       146
14.0       107
15.0        61
16.0        37
17.0        22
18.0        18
19.0        15
20.0        13
24.0        10
22.0         7
21.0         4
25.0         4
27.0         3
32.0         2
31.0         2
23.0         2
26.0         2
28.0         1
30.0         1
34.0         1
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-43" class="cell" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'mort_acc'</span>].sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>int_rate               -0.082583
dti                    -0.025439
revol_util              0.007514
pub_rec                 0.011552
pub_rec_bankruptcies    0.027239
loan_repaid             0.073111
open_acc                0.109205
installment             0.193694
revol_bal               0.194925
loan_amnt               0.222315
annual_inc              0.236320
total_acc               0.381072
mort_acc                1.000000
Name: mort_acc, dtype: float64</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>total_acc_avgs <span class="op">=</span> df.groupby(<span class="st">'total_acc'</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'mort_acc'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_mort_acc(total_acc,mort_acc):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.isnan(mort_acc):</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> total_acc_avgs[total_acc]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mort_acc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mort_acc'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: fill_mort_acc(x[<span class="st">'total_acc'</span>],x[<span class="st">'mort_acc'</span>]),axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-47" class="cell" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>loan_amnt                 0
term                      0
int_rate                  0
installment               0
grade                     0
sub_grade                 0
home_ownership            0
annual_inc                0
verification_status       0
issue_d                   0
loan_status               0
purpose                   0
dti                       0
earliest_cr_line          0
open_acc                  0
pub_rec                   0
revol_bal                 0
revol_util              276
total_acc                 0
initial_list_status       0
application_type          0
mort_acc                  0
pub_rec_bankruptcies    535
address                   0
loan_repaid               0
dtype: int64</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.00
term                    0.00
int_rate                0.00
installment             0.00
grade                   0.00
sub_grade               0.00
home_ownership          0.00
annual_inc              0.00
verification_status     0.00
issue_d                 0.00
loan_status             0.00
purpose                 0.00
dti                     0.00
earliest_cr_line        0.00
open_acc                0.00
pub_rec                 0.00
revol_bal               0.00
revol_util              0.07
total_acc               0.00
initial_list_status     0.00
application_type        0.00
mort_acc                0.00
pub_rec_bankruptcies    0.14
address                 0.00
loan_repaid             0.00
dtype: float64</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.0
term                    0.0
int_rate                0.0
installment             0.0
grade                   0.0
sub_grade               0.0
home_ownership          0.0
annual_inc              0.0
verification_status     0.0
issue_d                 0.0
loan_status             0.0
purpose                 0.0
dti                     0.0
earliest_cr_line        0.0
open_acc                0.0
pub_rec                 0.0
revol_bal               0.0
revol_util              0.0
total_acc               0.0
initial_list_status     0.0
application_type        0.0
mort_acc                0.0
pub_rec_bankruptcies    0.0
address                 0.0
loan_repaid             0.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="categorical-features" class="level2">
<h2 class="anchored" data-anchor-id="categorical-features">Categorical Features</h2>
<div id="cell-52" class="cell" data-tags="[]" data-execution_count="45">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df.select_dtypes([<span class="st">'object'</span>]).columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>Index(['term', 'grade', 'sub_grade', 'home_ownership', 'verification_status',
       'issue_d', 'loan_status', 'purpose', 'earliest_cr_line',
       'initial_list_status', 'application_type', 'address'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-tags="[]" data-execution_count="46">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'term'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>term
 36 months    301247
 60 months     93972
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'term'</span>] <span class="op">=</span> df[<span class="st">'term'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x.split()[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-55" class="cell" data-tags="[]" data-execution_count="48">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'term'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0         36
1         36
2         36
3         36
4         60
          ..
396025    60
396026    36
396027    36
396028    60
396029    36
Name: term, Length: 395219, dtype: int64</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-tags="[]" data-execution_count="49">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'zip_code'</span>] <span class="op">=</span> df[<span class="st">'address'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> address: address[<span class="op">-</span><span class="dv">5</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-57" class="cell" data-tags="[]" data-execution_count="50">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'zip_code'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>zip_code
70466    56880
22690    56413
30723    56402
48052    55811
00813    45725
29597    45393
05113    45300
11650    11210
93700    11126
86630    10959
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-58" class="cell" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'home_ownership'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>home_ownership
MORTGAGE    198022
RENT        159395
OWN          37660
OTHER          110
NONE            29
ANY              3
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-tags="[]" data-execution_count="52">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'home_ownership'</span>] <span class="op">=</span> df[<span class="st">'home_ownership'</span>].replace([<span class="st">'NONE'</span>,<span class="st">'ANY'</span>],<span class="st">'OTHER'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-60" class="cell" data-tags="[]" data-execution_count="53">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'home_ownership'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>home_ownership
MORTGAGE    198022
RENT        159395
OWN          37660
OTHER          142
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-61" class="cell" data-tags="[]" data-execution_count="54">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>columns_to_1hot <span class="op">=</span> [<span class="st">'home_ownership'</span>,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'verification_status'</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'application_type'</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'initial_list_status'</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'purpose'</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'zip_code'</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'sub_grade'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-62" class="cell" data-tags="[]" data-execution_count="55">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>df,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>columns_to_1hot,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                    drop_first<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                    dtype<span class="op">=</span><span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-63" class="cell" data-tags="[]" data-execution_count="56">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>Index(['loan_amnt', 'term', 'int_rate', 'installment', 'grade', 'annual_inc',
       'issue_d', 'loan_status', 'dti', 'earliest_cr_line', 'open_acc',
       'pub_rec', 'revol_bal', 'revol_util', 'total_acc', 'mort_acc',
       'pub_rec_bankruptcies', 'address', 'loan_repaid',
       'home_ownership_OTHER', 'home_ownership_OWN', 'home_ownership_RENT',
       'verification_status_Source Verified', 'verification_status_Verified',
       'application_type_INDIVIDUAL', 'application_type_JOINT',
       'initial_list_status_w', 'purpose_credit_card',
       'purpose_debt_consolidation', 'purpose_educational',
       'purpose_home_improvement', 'purpose_house', 'purpose_major_purchase',
       'purpose_medical', 'purpose_moving', 'purpose_other',
       'purpose_renewable_energy', 'purpose_small_business',
       'purpose_vacation', 'purpose_wedding', 'zip_code_05113',
       'zip_code_11650', 'zip_code_22690', 'zip_code_29597', 'zip_code_30723',
       'zip_code_48052', 'zip_code_70466', 'zip_code_86630', 'zip_code_93700',
       'sub_grade_A2', 'sub_grade_A3', 'sub_grade_A4', 'sub_grade_A5',
       'sub_grade_B1', 'sub_grade_B2', 'sub_grade_B3', 'sub_grade_B4',
       'sub_grade_B5', 'sub_grade_C1', 'sub_grade_C2', 'sub_grade_C3',
       'sub_grade_C4', 'sub_grade_C5', 'sub_grade_D1', 'sub_grade_D2',
       'sub_grade_D3', 'sub_grade_D4', 'sub_grade_D5', 'sub_grade_E1',
       'sub_grade_E2', 'sub_grade_E3', 'sub_grade_E4', 'sub_grade_E5',
       'sub_grade_F1', 'sub_grade_F2', 'sub_grade_F3', 'sub_grade_F4',
       'sub_grade_F5', 'sub_grade_G1', 'sub_grade_G2', 'sub_grade_G3',
       'sub_grade_G4', 'sub_grade_G5'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-tags="[]" data-execution_count="57">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'earliest_cr_line'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>0         Jun-1990
1         Jul-2004
2         Aug-2007
3         Sep-2006
4         Mar-1999
            ...   
396025    Nov-2004
396026    Feb-2006
396027    Mar-1997
396028    Nov-1990
396029    Sep-1998
Name: earliest_cr_line, Length: 395219, dtype: object</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-tags="[]" data-execution_count="58">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'earliest_cr_year'</span>] <span class="op">=</span> df[<span class="st">'earliest_cr_line'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x.split(<span class="st">'-'</span>)[<span class="op">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-66" class="cell" data-tags="[]" data-execution_count="59">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'earliest_cr_year'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>0         1990
1         2004
2         2007
3         2006
4         1999
          ... 
396025    2004
396026    2006
396027    1997
396028    1990
396029    1998
Name: earliest_cr_year, Length: 395219, dtype: int64</code></pre>
</div>
</div>
<div id="cell-67" class="cell" data-tags="[]" data-execution_count="60">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> [<span class="st">'earliest_cr_line'</span>,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'grade'</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'issue_d'</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'loan_status'</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'address'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-68" class="cell" data-tags="[]" data-execution_count="61">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns_to_drop,axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preprocessing" class="level1">
<h1>PREPROCESSING</h1>
<div id="cell-70" class="cell" data-tags="[]" data-execution_count="62">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">installment</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">dti</th>
<th data-quarto-table-cell-role="th">open_acc</th>
<th data-quarto-table-cell-role="th">pub_rec</th>
<th data-quarto-table-cell-role="th">revol_bal</th>
<th data-quarto-table-cell-role="th">revol_util</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">sub_grade_F2</th>
<th data-quarto-table-cell-role="th">sub_grade_F3</th>
<th data-quarto-table-cell-role="th">sub_grade_F4</th>
<th data-quarto-table-cell-role="th">sub_grade_F5</th>
<th data-quarto-table-cell-role="th">sub_grade_G1</th>
<th data-quarto-table-cell-role="th">sub_grade_G2</th>
<th data-quarto-table-cell-role="th">sub_grade_G3</th>
<th data-quarto-table-cell-role="th">sub_grade_G4</th>
<th data-quarto-table-cell-role="th">sub_grade_G5</th>
<th data-quarto-table-cell-role="th">earliest_cr_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10000.0</td>
<td>36</td>
<td>11.44</td>
<td>329.48</td>
<td>117000.0</td>
<td>26.24</td>
<td>16.0</td>
<td>0.0</td>
<td>36369.0</td>
<td>41.8</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8000.0</td>
<td>36</td>
<td>11.99</td>
<td>265.68</td>
<td>65000.0</td>
<td>22.05</td>
<td>17.0</td>
<td>0.0</td>
<td>20131.0</td>
<td>53.3</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2004</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>15600.0</td>
<td>36</td>
<td>10.49</td>
<td>506.97</td>
<td>43057.0</td>
<td>12.79</td>
<td>13.0</td>
<td>0.0</td>
<td>11987.0</td>
<td>92.2</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7200.0</td>
<td>36</td>
<td>6.49</td>
<td>220.65</td>
<td>54000.0</td>
<td>2.60</td>
<td>6.0</td>
<td>0.0</td>
<td>5472.0</td>
<td>21.5</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2006</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24375.0</td>
<td>60</td>
<td>17.27</td>
<td>609.33</td>
<td>55000.0</td>
<td>33.95</td>
<td>13.0</td>
<td>0.0</td>
<td>24584.0</td>
<td>69.8</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1999</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396025</td>
<td>10000.0</td>
<td>60</td>
<td>10.99</td>
<td>217.38</td>
<td>40000.0</td>
<td>15.63</td>
<td>6.0</td>
<td>0.0</td>
<td>1990.0</td>
<td>34.3</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396026</td>
<td>21000.0</td>
<td>36</td>
<td>12.29</td>
<td>700.42</td>
<td>110000.0</td>
<td>21.45</td>
<td>6.0</td>
<td>0.0</td>
<td>43263.0</td>
<td>95.7</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2006</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396027</td>
<td>5000.0</td>
<td>36</td>
<td>9.99</td>
<td>161.32</td>
<td>56500.0</td>
<td>17.56</td>
<td>15.0</td>
<td>0.0</td>
<td>32704.0</td>
<td>66.9</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396028</td>
<td>21000.0</td>
<td>60</td>
<td>15.31</td>
<td>503.02</td>
<td>64000.0</td>
<td>15.88</td>
<td>9.0</td>
<td>0.0</td>
<td>15704.0</td>
<td>53.8</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1990</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396029</td>
<td>2000.0</td>
<td>36</td>
<td>13.61</td>
<td>67.98</td>
<td>42996.0</td>
<td>8.32</td>
<td>3.0</td>
<td>0.0</td>
<td>4292.0</td>
<td>91.3</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1998</td>
</tr>
</tbody>
</table>

<p>395219 rows × 79 columns</p>
</div>
</div>
</div>
<section id="traintestval-split" class="level2">
<h2 class="anchored" data-anchor-id="traintestval-split">TRAIN/TEST/VAL SPLIT</h2>
<div id="cell-72" class="cell" data-tags="[]" data-execution_count="63">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'loan_repaid'</span>,axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'loan_repaid'</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell" data-tags="[]" data-execution_count="64">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>X_train_temp, X_test, y_train_temp, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">594</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X_train_temp, y_train_temp, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">594</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-74" class="cell" data-tags="[]" data-execution_count="65">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training set shape: "</span>, X_train.shape, y_train.shape)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Validation set shape: "</span>, X_val.shape, y_val.shape)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test set shape: "</span>, X_test.shape, y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set shape:  (237131, 78) (237131,)
Validation set shape:  (79044, 78) (79044,)
Test set shape:  (79044, 78) (79044,)</code></pre>
</div>
</div>
</section>
<section id="normalizing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="normalizing-the-data">Normalizing the Data</h2>
<div id="cell-76" class="cell" data-tags="[]" data-execution_count="66">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-77" class="cell" data-tags="[]" data-execution_count="67">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> scaler.transform(X_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-78" class="cell" data-tags="[]" data-execution_count="68">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([[-1.08996185, -0.55794638, -0.78084497, ..., -0.03033429,
        -0.02786656,  0.71431254],
       [-1.08996185,  1.79228692, -0.23107726, ..., -0.03033429,
        -0.02786656,  0.15783544],
       [ 1.89932034,  1.79228692,  2.07973496, ..., -0.03033429,
        -0.02786656, -0.25952238],
       ...,
       [ 0.46446489, -0.55794638,  0.70084605, ..., -0.03033429,
        -0.02786656,  0.01871617],
       [-1.20953314, -0.55794638, -0.2578952 , ..., -0.03033429,
        -0.02786656,  0.57519326],
       [ 1.19683902,  1.79228692,  1.86519147, ..., -0.03033429,
        -0.02786656,  0.85343181]])</code></pre>
</div>
</div>
</section>
</section>
<section id="model-1" class="level1">
<h1>Model 1</h1>
<p>79-&gt;256-&gt;128-&gt;64-&gt;1</p>
<div id="cell-80" class="cell" data-tags="[]" data-execution_count="107">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>X_train.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>(237131, 78)</code></pre>
</div>
</div>
<div id="cell-81" class="cell" data-tags="[]" data-execution_count="114">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">78</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">256</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">64</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span><span class="st">'linear'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-82" class="cell" data-tags="[]" data-execution_count="115">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.001</span>),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-83" class="cell" data-tags="[]" data-execution_count="116">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                               patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                               restore_best_weights<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-84" class="cell" data-tags="[]" data-execution_count="117">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>model.fit(X_train,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>          y_train,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>          epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>          batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>          validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>          callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3362 - val_loss: 0.2708
Epoch 2/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2736 - val_loss: 0.2661
Epoch 3/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2662 - val_loss: 0.2632
Epoch 4/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2632 - val_loss: 0.2618
Epoch 5/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2618 - val_loss: 0.2636
Epoch 6/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2610 - val_loss: 0.2616
Epoch 7/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2609 - val_loss: 0.2611
Epoch 8/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2601 - val_loss: 0.2621
Epoch 9/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2597 - val_loss: 0.2603
Epoch 10/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2595 - val_loss: 0.2614
Epoch 11/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2594 - val_loss: 0.2619
Epoch 12/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2592 - val_loss: 0.2606
Epoch 13/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2586 - val_loss: 0.2608
Epoch 14/25
927/927 [==============================] - 3s 4ms/step - loss: 0.2585 - val_loss: 0.2615</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>&lt;keras.src.callbacks.History at 0x1b962c95990&gt;</code></pre>
</div>
</div>
<div id="cell-85" class="cell" data-tags="[]" data-execution_count="118">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> pd.DataFrame(model.history.history)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>losses.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-75-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-86" class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (model.predict(X_test) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test,predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-87" class="cell" data-tags="[]" data-execution_count="155">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> Sequential()</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>model2.add(Dense(<span class="dv">78</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>model2.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>model2.add(Dense(<span class="dv">39</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>model2.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>model2.add(Dense(<span class="dv">19</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>model2.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>model2.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span><span class="st">'linear'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-88" class="cell" data-tags="[]" data-execution_count="156">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model2.<span class="bu">compile</span>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.0001</span>),</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-89" class="cell" data-tags="[]" data-execution_count="157">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                               patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                               restore_best_weights<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-90" class="cell" data-tags="[]" data-execution_count="158">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>model2.fit(X_train,</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>          y_train,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>          epochs<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>          batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>          validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>          callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
927/927 [==============================] - 3s 2ms/step - loss: 0.9819 - val_loss: 0.5578
Epoch 2/100
927/927 [==============================] - 2s 2ms/step - loss: 0.6567 - val_loss: 0.5368
Epoch 3/100
927/927 [==============================] - 2s 2ms/step - loss: 0.5728 - val_loss: 0.5007
Epoch 4/100
927/927 [==============================] - 2s 2ms/step - loss: 0.5287 - val_loss: 0.4629
Epoch 5/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4945 - val_loss: 0.4288
Epoch 6/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4689 - val_loss: 0.4012
Epoch 7/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4458 - val_loss: 0.3803
Epoch 8/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4275 - val_loss: 0.3674
Epoch 9/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4092 - val_loss: 0.3529
Epoch 10/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3927 - val_loss: 0.3324
Epoch 11/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3787 - val_loss: 0.3084
Epoch 12/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3621 - val_loss: 0.2886
Epoch 13/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3517 - val_loss: 0.2777
Epoch 14/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3405 - val_loss: 0.2729
Epoch 15/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3329 - val_loss: 0.2710
Epoch 16/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3255 - val_loss: 0.2695
Epoch 17/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3189 - val_loss: 0.2684
Epoch 18/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3133 - val_loss: 0.2677
Epoch 19/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3096 - val_loss: 0.2672
Epoch 20/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3067 - val_loss: 0.2665
Epoch 21/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3036 - val_loss: 0.2659
Epoch 22/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3006 - val_loss: 0.2652
Epoch 23/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2981 - val_loss: 0.2646
Epoch 24/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2960 - val_loss: 0.2641
Epoch 25/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2948 - val_loss: 0.2633
Epoch 26/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2926 - val_loss: 0.2628
Epoch 27/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2910 - val_loss: 0.2626
Epoch 28/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2896 - val_loss: 0.2624
Epoch 29/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2883 - val_loss: 0.2624
Epoch 30/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2873 - val_loss: 0.2617
Epoch 31/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2866 - val_loss: 0.2617
Epoch 32/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2847 - val_loss: 0.2612
Epoch 33/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2847 - val_loss: 0.2611
Epoch 34/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2841 - val_loss: 0.2608
Epoch 35/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2827 - val_loss: 0.2606
Epoch 36/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2822 - val_loss: 0.2603
Epoch 37/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2816 - val_loss: 0.2605
Epoch 38/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2820 - val_loss: 0.2602
Epoch 39/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2805 - val_loss: 0.2600
Epoch 40/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2809 - val_loss: 0.2600
Epoch 41/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2810 - val_loss: 0.2601
Epoch 42/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2798 - val_loss: 0.2598
Epoch 43/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2796 - val_loss: 0.2598
Epoch 44/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2798 - val_loss: 0.2598
Epoch 45/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2795 - val_loss: 0.2596
Epoch 46/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2798 - val_loss: 0.2596
Epoch 47/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2789 - val_loss: 0.2593
Epoch 48/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2787 - val_loss: 0.2594
Epoch 49/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2777 - val_loss: 0.2591
Epoch 50/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2777 - val_loss: 0.2593
Epoch 51/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2781 - val_loss: 0.2592
Epoch 52/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2785 - val_loss: 0.2595
Epoch 53/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2774 - val_loss: 0.2590
Epoch 54/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2776 - val_loss: 0.2592
Epoch 55/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2768 - val_loss: 0.2592
Epoch 56/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2770 - val_loss: 0.2590
Epoch 57/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2767 - val_loss: 0.2591
Epoch 58/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2767 - val_loss: 0.2588
Epoch 59/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2767 - val_loss: 0.2587
Epoch 60/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2776 - val_loss: 0.2587
Epoch 61/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2769 - val_loss: 0.2586
Epoch 62/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2759 - val_loss: 0.2585
Epoch 63/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2759 - val_loss: 0.2584
Epoch 64/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2759 - val_loss: 0.2584
Epoch 65/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2755 - val_loss: 0.2585
Epoch 66/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2756 - val_loss: 0.2584
Epoch 67/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2753 - val_loss: 0.2583
Epoch 68/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2750 - val_loss: 0.2585
Epoch 69/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2754 - val_loss: 0.2582
Epoch 70/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2749 - val_loss: 0.2583
Epoch 71/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2749 - val_loss: 0.2585
Epoch 72/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2750 - val_loss: 0.2584
Epoch 73/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2748 - val_loss: 0.2583
Epoch 74/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2738 - val_loss: 0.2580
Epoch 75/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2745 - val_loss: 0.2581
Epoch 76/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2754 - val_loss: 0.2581
Epoch 77/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2740 - val_loss: 0.2582
Epoch 78/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2738 - val_loss: 0.2581
Epoch 79/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2749 - val_loss: 0.2581
Epoch 80/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2746 - val_loss: 0.2584
Epoch 81/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2741 - val_loss: 0.2581
Epoch 82/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2733 - val_loss: 0.2579
Epoch 83/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2733 - val_loss: 0.2579
Epoch 84/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2730 - val_loss: 0.2579
Epoch 85/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2735 - val_loss: 0.2579
Epoch 86/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2735 - val_loss: 0.2578
Epoch 87/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2736 - val_loss: 0.2577
Epoch 88/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2733 - val_loss: 0.2579
Epoch 89/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2733 - val_loss: 0.2577
Epoch 90/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2736 - val_loss: 0.2577
Epoch 91/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2729 - val_loss: 0.2578
Epoch 92/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2733 - val_loss: 0.2578
Epoch 93/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2732 - val_loss: 0.2578
Epoch 94/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2731 - val_loss: 0.2577
Epoch 95/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2729 - val_loss: 0.2577
Epoch 96/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2728 - val_loss: 0.2579
Epoch 97/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2737 - val_loss: 0.2577
Epoch 98/100
927/927 [==============================] - 2s 3ms/step - loss: 0.2726 - val_loss: 0.2577
Epoch 99/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2721 - val_loss: 0.2574
Epoch 100/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2735 - val_loss: 0.2577</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>&lt;keras.src.callbacks.History at 0x21f06edf710&gt;</code></pre>
</div>
</div>
<div id="cell-91" class="cell" data-tags="[]" data-execution_count="159">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> pd.DataFrame(model2.history.history)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>losses.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loss</th>
<th data-quarto-table-cell-role="th">val_loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.981942</td>
<td>0.557821</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.656682</td>
<td>0.536773</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.572845</td>
<td>0.500686</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.528722</td>
<td>0.462937</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.494528</td>
<td>0.428844</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-92" class="cell" data-tags="[]" data-execution_count="160">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>losses.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-82-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-93" class="cell" data-tags="[]" data-execution_count="161">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (model2.predict(X_test) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test,predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 731us/step
              precision    recall  f1-score   support

           0       0.99      0.44      0.61     15421
           1       0.88      1.00      0.94     63623

    accuracy                           0.89     79044
   macro avg       0.94      0.72      0.77     79044
weighted avg       0.90      0.89      0.87     79044
</code></pre>
</div>
</div>
</section>
<section id="model-3---more-complicated-architecture" class="level1">
<h1>Model 3 - More complicated Architecture</h1>
<div id="cell-95" class="cell" data-tags="[]" data-execution_count="169">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> Sequential()</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>model3.add(Dense(<span class="dv">78</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>model3.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>model3.add(Dense(<span class="dv">250</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>model3.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>model3.add(Dense(<span class="dv">125</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>model3.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>model3.add(Dense(<span class="dv">60</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>model3.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>model3.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span><span class="st">'linear'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-96" class="cell" data-tags="[]" data-execution_count="170">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>model3.<span class="bu">compile</span>(</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.0001</span>),</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-97" class="cell" data-tags="[]" data-execution_count="171">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>                               patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                               restore_best_weights<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-98" class="cell" data-tags="[]" data-execution_count="172">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>model3.fit(X_train,</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>          y_train,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>          epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>          batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>          validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>          callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
927/927 [==============================] - 5s 4ms/step - loss: 0.8082 - val_loss: 0.6075
Epoch 2/100
927/927 [==============================] - 4s 4ms/step - loss: 0.5898 - val_loss: 0.5811
Epoch 3/100
927/927 [==============================] - 4s 4ms/step - loss: 0.5416 - val_loss: 0.5447
Epoch 4/100
927/927 [==============================] - 4s 4ms/step - loss: 0.5056 - val_loss: 0.4886
Epoch 5/100
927/927 [==============================] - 4s 4ms/step - loss: 0.4703 - val_loss: 0.4320
Epoch 6/100
927/927 [==============================] - 4s 4ms/step - loss: 0.4390 - val_loss: 0.3934
Epoch 7/100
927/927 [==============================] - 4s 4ms/step - loss: 0.4113 - val_loss: 0.3583
Epoch 8/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3803 - val_loss: 0.3202
Epoch 9/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3522 - val_loss: 0.2925
Epoch 10/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3321 - val_loss: 0.2872
Epoch 11/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3205 - val_loss: 0.2821
Epoch 12/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3111 - val_loss: 0.2804
Epoch 13/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3043 - val_loss: 0.2772
Epoch 14/100
927/927 [==============================] - 4s 4ms/step - loss: 0.3002 - val_loss: 0.2751
Epoch 15/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2954 - val_loss: 0.2744
Epoch 16/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2909 - val_loss: 0.2726
Epoch 17/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2886 - val_loss: 0.2724
Epoch 18/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2858 - val_loss: 0.2715
Epoch 19/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2831 - val_loss: 0.2697
Epoch 20/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2822 - val_loss: 0.2709
Epoch 21/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2797 - val_loss: 0.2708
Epoch 22/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2780 - val_loss: 0.2699
Epoch 23/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2767 - val_loss: 0.2693
Epoch 24/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2767 - val_loss: 0.2701
Epoch 25/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2747 - val_loss: 0.2689
Epoch 26/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2735 - val_loss: 0.2687
Epoch 27/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2724 - val_loss: 0.2682
Epoch 28/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2714 - val_loss: 0.2685
Epoch 29/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2705 - val_loss: 0.2689
Epoch 30/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2703 - val_loss: 0.2673
Epoch 31/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2701 - val_loss: 0.2678
Epoch 32/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2694 - val_loss: 0.2667
Epoch 33/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2688 - val_loss: 0.2671
Epoch 34/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2683 - val_loss: 0.2669
Epoch 35/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2677 - val_loss: 0.2664
Epoch 36/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2674 - val_loss: 0.2669
Epoch 37/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2666 - val_loss: 0.2661
Epoch 38/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2665 - val_loss: 0.2658
Epoch 39/100
927/927 [==============================] - 4s 5ms/step - loss: 0.2658 - val_loss: 0.2658
Epoch 40/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2661 - val_loss: 0.2654
Epoch 41/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2652 - val_loss: 0.2661
Epoch 42/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2651 - val_loss: 0.2655
Epoch 43/100
927/927 [==============================] - 4s 5ms/step - loss: 0.2643 - val_loss: 0.2654
Epoch 44/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2648 - val_loss: 0.2658
Epoch 45/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2648 - val_loss: 0.2651
Epoch 46/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2644 - val_loss: 0.2653
Epoch 47/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2644 - val_loss: 0.2644
Epoch 48/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2634 - val_loss: 0.2647
Epoch 49/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2639 - val_loss: 0.2644
Epoch 50/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2637 - val_loss: 0.2642
Epoch 51/100
927/927 [==============================] - 4s 5ms/step - loss: 0.2629 - val_loss: 0.2644
Epoch 52/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2630 - val_loss: 0.2639
Epoch 53/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2628 - val_loss: 0.2641
Epoch 54/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2630 - val_loss: 0.2641
Epoch 55/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2629 - val_loss: 0.2637
Epoch 56/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2621 - val_loss: 0.2639
Epoch 57/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2623 - val_loss: 0.2639
Epoch 58/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2625 - val_loss: 0.2637
Epoch 59/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2627 - val_loss: 0.2635
Epoch 60/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2620 - val_loss: 0.2638
Epoch 61/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2621 - val_loss: 0.2638
Epoch 62/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2623 - val_loss: 0.2641
Epoch 63/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2619 - val_loss: 0.2629
Epoch 64/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2618 - val_loss: 0.2634
Epoch 65/100
927/927 [==============================] - 4s 5ms/step - loss: 0.2615 - val_loss: 0.2629
Epoch 66/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2621 - val_loss: 0.2635
Epoch 67/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2619 - val_loss: 0.2627
Epoch 68/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2616 - val_loss: 0.2629
Epoch 69/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2611 - val_loss: 0.2627
Epoch 70/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2612 - val_loss: 0.2628
Epoch 71/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2611 - val_loss: 0.2636
Epoch 72/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2611 - val_loss: 0.2627
Epoch 73/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2612 - val_loss: 0.2629
Epoch 74/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2612 - val_loss: 0.2629
Epoch 75/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2610 - val_loss: 0.2628
Epoch 76/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2606 - val_loss: 0.2625
Epoch 77/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2610 - val_loss: 0.2629
Epoch 78/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2603 - val_loss: 0.2630
Epoch 79/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2605 - val_loss: 0.2619
Epoch 80/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2604 - val_loss: 0.2622
Epoch 81/100
927/927 [==============================] - 4s 5ms/step - loss: 0.2605 - val_loss: 0.2618
Epoch 82/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2604 - val_loss: 0.2628
Epoch 83/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2605 - val_loss: 0.2620
Epoch 84/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2607 - val_loss: 0.2623
Epoch 85/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2602 - val_loss: 0.2625
Epoch 86/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2602 - val_loss: 0.2613
Epoch 87/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2602 - val_loss: 0.2619
Epoch 88/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2607 - val_loss: 0.2620
Epoch 89/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2600 - val_loss: 0.2618
Epoch 90/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2600 - val_loss: 0.2615
Epoch 91/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2599 - val_loss: 0.2626
Epoch 92/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2603 - val_loss: 0.2622
Epoch 93/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2601 - val_loss: 0.2620
Epoch 94/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2601 - val_loss: 0.2621
Epoch 95/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2602 - val_loss: 0.2628
Epoch 96/100
927/927 [==============================] - 4s 4ms/step - loss: 0.2599 - val_loss: 0.2624</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="172">
<pre><code>&lt;keras.src.callbacks.History at 0x21f08b01c50&gt;</code></pre>
</div>
</div>
<div id="cell-99" class="cell" data-tags="[]" data-execution_count="173">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>losses3 <span class="op">=</span> pd.DataFrame(model3.history.history)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>losses3.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-88-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-4---leaky-relu" class="level1">
<h1>Model 4 - Leaky ReLU</h1>
<div id="cell-101" class="cell" data-tags="[]" data-execution_count="176">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>model4 <span class="op">=</span> Sequential()</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>model4.add(Dense(<span class="dv">78</span>))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>model4.add(LeakyReLU(alpha<span class="op">=</span><span class="fl">0.01</span>))</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>model4.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>model4.add(Dense(<span class="dv">39</span>))</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>model4.add(LeakyReLU(alpha<span class="op">=</span><span class="fl">0.01</span>))</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>model4.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>model4.add(Dense(<span class="dv">19</span>))</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>model4.add(LeakyReLU(alpha<span class="op">=</span><span class="fl">0.01</span>))</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>model4.add(Dropout(<span class="fl">0.7</span>))</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>model4.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span><span class="st">'linear'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-102" class="cell" data-tags="[]" data-execution_count="177">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>model4.<span class="bu">compile</span>(</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.0001</span>),</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-103" class="cell" data-tags="[]" data-execution_count="178">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>                               patience<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>                               restore_best_weights<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-104" class="cell" data-tags="[]" data-execution_count="179">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>model4.fit(X_train,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>          y_train,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>          epochs<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>          batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>          validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>          callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
927/927 [==============================] - 3s 2ms/step - loss: 0.8590 - val_loss: 0.5786
Epoch 2/100
927/927 [==============================] - 2s 2ms/step - loss: 0.6239 - val_loss: 0.5416
Epoch 3/100
927/927 [==============================] - 2s 2ms/step - loss: 0.5620 - val_loss: 0.4985
Epoch 4/100
927/927 [==============================] - 2s 2ms/step - loss: 0.5214 - val_loss: 0.4565
Epoch 5/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4853 - val_loss: 0.4168
Epoch 6/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4620 - val_loss: 0.3930
Epoch 7/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4383 - val_loss: 0.3738
Epoch 8/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4208 - val_loss: 0.3546
Epoch 9/100
927/927 [==============================] - 2s 2ms/step - loss: 0.4002 - val_loss: 0.3308
Epoch 10/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3818 - val_loss: 0.3044
Epoch 11/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3649 - val_loss: 0.2858
Epoch 12/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3514 - val_loss: 0.2764
Epoch 13/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3389 - val_loss: 0.2719
Epoch 14/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3301 - val_loss: 0.2699
Epoch 15/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3211 - val_loss: 0.2680
Epoch 16/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3159 - val_loss: 0.2671
Epoch 17/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3102 - val_loss: 0.2660
Epoch 18/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3041 - val_loss: 0.2652
Epoch 19/100
927/927 [==============================] - 2s 2ms/step - loss: 0.3018 - val_loss: 0.2643
Epoch 20/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2979 - val_loss: 0.2638
Epoch 21/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2949 - val_loss: 0.2626
Epoch 22/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2928 - val_loss: 0.2622
Epoch 23/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2903 - val_loss: 0.2618
Epoch 24/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2885 - val_loss: 0.2616
Epoch 25/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2864 - val_loss: 0.2612
Epoch 26/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2848 - val_loss: 0.2610
Epoch 27/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2843 - val_loss: 0.2608
Epoch 28/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2837 - val_loss: 0.2606
Epoch 29/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2821 - val_loss: 0.2603
Epoch 30/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2814 - val_loss: 0.2603
Epoch 31/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2811 - val_loss: 0.2600
Epoch 32/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2795 - val_loss: 0.2596
Epoch 33/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2790 - val_loss: 0.2596
Epoch 34/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2792 - val_loss: 0.2595
Epoch 35/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2776 - val_loss: 0.2593
Epoch 36/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2769 - val_loss: 0.2591
Epoch 37/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2779 - val_loss: 0.2593
Epoch 38/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2758 - val_loss: 0.2590
Epoch 39/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2759 - val_loss: 0.2588
Epoch 40/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2758 - val_loss: 0.2587
Epoch 41/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2753 - val_loss: 0.2586
Epoch 42/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2744 - val_loss: 0.2587
Epoch 43/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2745 - val_loss: 0.2585
Epoch 44/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2737 - val_loss: 0.2584
Epoch 45/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2743 - val_loss: 0.2583
Epoch 46/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2734 - val_loss: 0.2584
Epoch 47/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2734 - val_loss: 0.2582
Epoch 48/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2729 - val_loss: 0.2580
Epoch 49/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2732 - val_loss: 0.2581
Epoch 50/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2728 - val_loss: 0.2580
Epoch 51/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2716 - val_loss: 0.2578
Epoch 52/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2717 - val_loss: 0.2579
Epoch 53/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2716 - val_loss: 0.2578
Epoch 54/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2714 - val_loss: 0.2578
Epoch 55/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2704 - val_loss: 0.2578
Epoch 56/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2708 - val_loss: 0.2578
Epoch 57/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2711 - val_loss: 0.2576
Epoch 58/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2705 - val_loss: 0.2576
Epoch 59/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2702 - val_loss: 0.2576
Epoch 60/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2702 - val_loss: 0.2577
Epoch 61/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2699 - val_loss: 0.2578
Epoch 62/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2692 - val_loss: 0.2575
Epoch 63/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2694 - val_loss: 0.2576
Epoch 64/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2698 - val_loss: 0.2579
Epoch 65/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2692 - val_loss: 0.2577
Epoch 66/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2691 - val_loss: 0.2575
Epoch 67/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2691 - val_loss: 0.2576
Epoch 68/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2684 - val_loss: 0.2576
Epoch 69/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2684 - val_loss: 0.2576
Epoch 70/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2680 - val_loss: 0.2575
Epoch 71/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2681 - val_loss: 0.2574
Epoch 72/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2687 - val_loss: 0.2575
Epoch 73/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2671 - val_loss: 0.2574
Epoch 74/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2672 - val_loss: 0.2573
Epoch 75/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2680 - val_loss: 0.2574
Epoch 76/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2673 - val_loss: 0.2572
Epoch 77/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2665 - val_loss: 0.2576
Epoch 78/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2676 - val_loss: 0.2578
Epoch 79/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2669 - val_loss: 0.2576
Epoch 80/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2668 - val_loss: 0.2572
Epoch 81/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2671 - val_loss: 0.2574
Epoch 82/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2672 - val_loss: 0.2576
Epoch 83/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2661 - val_loss: 0.2574
Epoch 84/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2668 - val_loss: 0.2575
Epoch 85/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2664 - val_loss: 0.2574
Epoch 86/100
927/927 [==============================] - 2s 2ms/step - loss: 0.2667 - val_loss: 0.2577</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>&lt;keras.src.callbacks.History at 0x21f0cff9c50&gt;</code></pre>
</div>
</div>
<div id="cell-105" class="cell" data-tags="[]" data-execution_count="180">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>losses4 <span class="op">=</span> pd.DataFrame(model3.history.history)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>losses4.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-93-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-5---class-weights" class="level1">
<h1>Model 5 - Class Weights</h1>
<div id="cell-107" class="cell" data-tags="[]" data-execution_count="79">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>class_weights <span class="op">=</span> compute_class_weight(<span class="st">'balanced'</span>, classes<span class="op">=</span>np.unique(y_train), y<span class="op">=</span>y_train)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>class_weight_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">enumerate</span>(class_weights))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-108" class="cell" data-tags="[]" data-execution_count="80">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">78</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.2</span>))</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-109" class="cell" data-tags="[]" data-execution_count="81">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>Adam(<span class="fl">0.0001</span>),</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-110" class="cell" data-tags="[]" data-execution_count="82">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    restore_best_weights<span class="op">=</span><span class="va">True</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-111" class="cell" data-tags="[]" data-execution_count="83">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>model.fit(</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    X_train,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    y_train,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    validation_data<span class="op">=</span>(X_val, y_val),</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    callbacks<span class="op">=</span>[early_stopping],</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    class_weight<span class="op">=</span>class_weight_dict</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/25
927/927 [==============================] - 5s 4ms/step - loss: 0.5085 - val_loss: 0.3829
Epoch 2/25
927/927 [==============================] - 4s 4ms/step - loss: 0.4166 - val_loss: 0.3687
Epoch 3/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3966 - val_loss: 0.3713
Epoch 4/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3839 - val_loss: 0.3628
Epoch 5/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3782 - val_loss: 0.3659
Epoch 6/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3732 - val_loss: 0.3597
Epoch 7/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3693 - val_loss: 0.3593
Epoch 8/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3662 - val_loss: 0.3529
Epoch 9/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3653 - val_loss: 0.3514
Epoch 10/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3624 - val_loss: 0.3576
Epoch 11/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3613 - val_loss: 0.3579
Epoch 12/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3604 - val_loss: 0.3497
Epoch 13/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3598 - val_loss: 0.3492
Epoch 14/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3589 - val_loss: 0.3566
Epoch 15/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3581 - val_loss: 0.3513
Epoch 16/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3578 - val_loss: 0.3554
Epoch 17/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3575 - val_loss: 0.3460
Epoch 18/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3565 - val_loss: 0.3480
Epoch 19/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3563 - val_loss: 0.3478
Epoch 20/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3562 - val_loss: 0.3446
Epoch 21/25
927/927 [==============================] - 3s 4ms/step - loss: 0.3554 - val_loss: 0.3486
Epoch 22/25
927/927 [==============================] - 3s 4ms/step - loss: 0.3554 - val_loss: 0.3484
Epoch 23/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3548 - val_loss: 0.3517
Epoch 24/25
927/927 [==============================] - 4s 4ms/step - loss: 0.3548 - val_loss: 0.3480
Epoch 25/25
927/927 [==============================] - 3s 4ms/step - loss: 0.3543 - val_loss: 0.3485</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>&lt;keras.src.callbacks.History at 0x1b91892c350&gt;</code></pre>
</div>
</div>
<div id="cell-112" class="cell" data-tags="[]" data-execution_count="84">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> pd.DataFrame(model.history.history)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>losses.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-99-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-113" class="cell" data-tags="[]" data-execution_count="85">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (model.predict(X_test) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test,predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 795us/step
              precision    recall  f1-score   support

           0       0.41      0.91      0.56     15516
           1       0.97      0.68      0.80     63528

    accuracy                           0.72     79044
   macro avg       0.69      0.79      0.68     79044
weighted avg       0.86      0.72      0.75     79044
</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>