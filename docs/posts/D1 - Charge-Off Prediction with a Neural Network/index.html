<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Smith">
<meta name="dcterms.date" content="2024-02-04">

<title>djs - Portfolio - Charge-Off Prediction With a Neural Network Tuned Using Optuna</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">djs - Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Charge-Off Prediction With a Neural Network Tuned Using Optuna</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Pandas</div>
    <div class="quarto-category">TensorFlow</div>
    <div class="quarto-category">Optuna</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Smith </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 4, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="imports" class="level1">
<h1>IMPORTS</h1>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">—-</h2>
<p>There are many LendingClub data sets on Kaggle. Here is the information on this particular data set:</p>

<table class="dataframe table table-sm table-striped small">
<thead>
<tr>
<th>
</th>
<th>
LoanStatNew
</th>
<th>
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
loan_amnt
</td>
<td>
The listed amount of the loan applied for by the borrower. If at some point in time, the credit department reduces the loan amount, then it will be reflected in this value.
</td>
</tr>
<tr>
<th>
1
</th>
<td>
term
</td>
<td>
The number of payments on the loan. Values are in months and can be either 36 or 60.
</td>
</tr>
<tr>
<th>
2
</th>
<td>
int_rate
</td>
<td>
Interest Rate on the loan
</td>
</tr>
<tr>
<th>
3
</th>
<td>
installment
</td>
<td>
The monthly payment owed by the borrower if the loan originates.
</td>
</tr>
<tr>
<th>
4
</th>
<td>
grade
</td>
<td>
LC assigned loan grade
</td>
</tr>
<tr>
<th>
5
</th>
<td>
sub_grade
</td>
<td>
LC assigned loan subgrade
</td>
</tr>
<tr>
<th>
6
</th>
<td>
emp_title
</td>
<td>
The job title supplied by the Borrower when applying for the loan.*
</td>
</tr>
<tr>
<th>
7
</th>
<td>
emp_length
</td>
<td>
Employment length in years. Possible values are between 0 and 10 where 0 means less than one year and 10 means ten or more years.
</td>
</tr>
<tr>
<th>
8
</th>
<td>
home_ownership
</td>
<td>
The home ownership status provided by the borrower during registration&nbsp;or obtained from the credit report.&nbsp;Our values are: RENT, OWN, MORTGAGE, OTHER
</td>
</tr>
<tr>
<th>
9
</th>
<td>
annual_inc
</td>
<td>
The self-reported annual income provided by the borrower during registration.
</td>
</tr>
<tr>
<th>
10
</th>
<td>
verification_status
</td>
<td>
Indicates if income was verified by LC, not verified, or if the income source was verified
</td>
</tr>
<tr>
<th>
11
</th>
<td>
issue_d
</td>
<td>
The month which the loan was funded
</td>
</tr>
<tr>
<th>
12
</th>
<td>
loan_status
</td>
<td>
Current status of the loan
</td>
</tr>
<tr>
<th>
13
</th>
<td>
purpose
</td>
<td>
A category provided by the borrower for the loan request.
</td>
</tr>
<tr>
<th>
14
</th>
<td>
title
</td>
<td>
The loan title provided by the borrower
</td>
</tr>
<tr>
<th>
15
</th>
<td>
zip_code
</td>
<td>
The first 3 numbers of the zip code provided by the borrower in the loan application.
</td>
</tr>
<tr>
<th>
16
</th>
<td>
addr_state
</td>
<td>
The state provided by the borrower in the loan application
</td>
</tr>
<tr>
<th>
17
</th>
<td>
dti
</td>
<td>
A ratio calculated using the borrower’s total monthly debt payments on the total debt obligations, excluding mortgage and the requested LC loan, divided by the borrower’s self-reported monthly income.
</td>
</tr>
<tr>
<th>
18
</th>
<td>
earliest_cr_line
</td>
<td>
The month the borrower’s earliest reported credit line was opened
</td>
</tr>
<tr>
<th>
19
</th>
<td>
open_acc
</td>
<td>
The number of open credit lines in the borrower’s credit file.
</td>
</tr>
<tr>
<th>
20
</th>
<td>
pub_rec
</td>
<td>
Number of derogatory public records
</td>
</tr>
<tr>
<th>
21
</th>
<td>
revol_bal
</td>
<td>
Total credit revolving balance
</td>
</tr>
<tr>
<th>
22
</th>
<td>
revol_util
</td>
<td>
Revolving line utilization rate, or the amount of credit the borrower is using relative to all available revolving credit.
</td>
</tr>
<tr>
<th>
23
</th>
<td>
total_acc
</td>
<td>
The total number of credit lines currently in the borrower’s credit file
</td>
</tr>
<tr>
<th>
24
</th>
<td>
initial_list_status
</td>
<td>
The initial listing status of the loan. Possible values are – W, F
</td>
</tr>
<tr>
<th>
25
</th>
<td>
application_type
</td>
<td>
Indicates whether the loan is an individual application or a joint application with two co-borrowers
</td>
</tr>
<tr>
<th>
26
</th>
<td>
mort_acc
</td>
<td>
Number of mortgage accounts.
</td>
</tr>
<tr>
<th>
27
</th>
<td>
pub_rec_bankruptcies
</td>
<td>
Number of public record bankruptcies
</td>
</tr>
</tbody>

</table>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1">—</h2>
<div class="cell" data-tags="[]" data-execution_count="115">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, accuracy_score, f1_score</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Dropout</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> optuna</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Python version:"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">--</span>version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Python version:
Python 3.11.4</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'lending_club_loan.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 396030 entries, 0 to 396029
Data columns (total 27 columns):
 #   Column                Non-Null Count   Dtype  
---  ------                --------------   -----  
 0   loan_amnt             396030 non-null  float64
 1   term                  396030 non-null  object 
 2   int_rate              396030 non-null  float64
 3   installment           396030 non-null  float64
 4   grade                 396030 non-null  object 
 5   sub_grade             396030 non-null  object 
 6   emp_title             373103 non-null  object 
 7   emp_length            377729 non-null  object 
 8   home_ownership        396030 non-null  object 
 9   annual_inc            396030 non-null  float64
 10  verification_status   396030 non-null  object 
 11  issue_d               396030 non-null  object 
 12  loan_status           396030 non-null  object 
 13  purpose               396030 non-null  object 
 14  title                 394274 non-null  object 
 15  dti                   396030 non-null  float64
 16  earliest_cr_line      396030 non-null  object 
 17  open_acc              396030 non-null  float64
 18  pub_rec               396030 non-null  float64
 19  revol_bal             396030 non-null  float64
 20  revol_util            395754 non-null  float64
 21  total_acc             396030 non-null  float64
 22  initial_list_status   396030 non-null  object 
 23  application_type      396030 non-null  object 
 24  mort_acc              358235 non-null  float64
 25  pub_rec_bankruptcies  395495 non-null  float64
 26  address               396030 non-null  object 
dtypes: float64(12), object(15)
memory usage: 81.6+ MB</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">installment</th>
<th data-quarto-table-cell-role="th">grade</th>
<th data-quarto-table-cell-role="th">sub_grade</th>
<th data-quarto-table-cell-role="th">emp_title</th>
<th data-quarto-table-cell-role="th">emp_length</th>
<th data-quarto-table-cell-role="th">home_ownership</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">open_acc</th>
<th data-quarto-table-cell-role="th">pub_rec</th>
<th data-quarto-table-cell-role="th">revol_bal</th>
<th data-quarto-table-cell-role="th">revol_util</th>
<th data-quarto-table-cell-role="th">total_acc</th>
<th data-quarto-table-cell-role="th">initial_list_status</th>
<th data-quarto-table-cell-role="th">application_type</th>
<th data-quarto-table-cell-role="th">mort_acc</th>
<th data-quarto-table-cell-role="th">pub_rec_bankruptcies</th>
<th data-quarto-table-cell-role="th">address</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10000.0</td>
<td>36 months</td>
<td>11.44</td>
<td>329.48</td>
<td>B</td>
<td>B4</td>
<td>Marketing</td>
<td>10+ years</td>
<td>RENT</td>
<td>117000.0</td>
<td>...</td>
<td>16.0</td>
<td>0.0</td>
<td>36369.0</td>
<td>41.8</td>
<td>25.0</td>
<td>w</td>
<td>INDIVIDUAL</td>
<td>0.0</td>
<td>0.0</td>
<td>0174 Michelle Gateway\nMendozaberg, OK 22690</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8000.0</td>
<td>36 months</td>
<td>11.99</td>
<td>265.68</td>
<td>B</td>
<td>B5</td>
<td>Credit analyst</td>
<td>4 years</td>
<td>MORTGAGE</td>
<td>65000.0</td>
<td>...</td>
<td>17.0</td>
<td>0.0</td>
<td>20131.0</td>
<td>53.3</td>
<td>27.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>3.0</td>
<td>0.0</td>
<td>1076 Carney Fort Apt. 347\nLoganmouth, SD 05113</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>15600.0</td>
<td>36 months</td>
<td>10.49</td>
<td>506.97</td>
<td>B</td>
<td>B3</td>
<td>Statistician</td>
<td>&lt; 1 year</td>
<td>RENT</td>
<td>43057.0</td>
<td>...</td>
<td>13.0</td>
<td>0.0</td>
<td>11987.0</td>
<td>92.2</td>
<td>26.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>0.0</td>
<td>0.0</td>
<td>87025 Mark Dale Apt. 269\nNew Sabrina, WV 05113</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7200.0</td>
<td>36 months</td>
<td>6.49</td>
<td>220.65</td>
<td>A</td>
<td>A2</td>
<td>Client Advocate</td>
<td>6 years</td>
<td>RENT</td>
<td>54000.0</td>
<td>...</td>
<td>6.0</td>
<td>0.0</td>
<td>5472.0</td>
<td>21.5</td>
<td>13.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>0.0</td>
<td>0.0</td>
<td>823 Reid Ford\nDelacruzside, MA 00813</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24375.0</td>
<td>60 months</td>
<td>17.27</td>
<td>609.33</td>
<td>C</td>
<td>C5</td>
<td>Destiny Management Inc.</td>
<td>9 years</td>
<td>MORTGAGE</td>
<td>55000.0</td>
<td>...</td>
<td>13.0</td>
<td>0.0</td>
<td>24584.0</td>
<td>69.8</td>
<td>43.0</td>
<td>f</td>
<td>INDIVIDUAL</td>
<td>1.0</td>
<td>0.0</td>
<td>679 Luna Roads\nGreggshire, VA 11650</td>
</tr>
</tbody>
</table>

<p>5 rows × 27 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>EXPLORATORY DATA ANALYSIS</h1>
<div class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'loan_status'</span>,data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>&lt;Axes: xlabel='loan_status', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sns.displot(df[<span class="st">'loan_amnt'</span>],kde<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">installment</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">dti</th>
<th data-quarto-table-cell-role="th">open_acc</th>
<th data-quarto-table-cell-role="th">pub_rec</th>
<th data-quarto-table-cell-role="th">revol_bal</th>
<th data-quarto-table-cell-role="th">revol_util</th>
<th data-quarto-table-cell-role="th">total_acc</th>
<th data-quarto-table-cell-role="th">mort_acc</th>
<th data-quarto-table-cell-role="th">pub_rec_bankruptcies</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">loan_amnt</td>
<td>1.000000</td>
<td>0.168921</td>
<td>0.953929</td>
<td>0.336887</td>
<td>0.016636</td>
<td>0.198556</td>
<td>-0.077779</td>
<td>0.328320</td>
<td>0.099911</td>
<td>0.223886</td>
<td>0.222315</td>
<td>-0.106539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">int_rate</td>
<td>0.168921</td>
<td>1.000000</td>
<td>0.162758</td>
<td>-0.056771</td>
<td>0.079038</td>
<td>0.011649</td>
<td>0.060986</td>
<td>-0.011280</td>
<td>0.293659</td>
<td>-0.036404</td>
<td>-0.082583</td>
<td>0.057450</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">installment</td>
<td>0.953929</td>
<td>0.162758</td>
<td>1.000000</td>
<td>0.330381</td>
<td>0.015786</td>
<td>0.188973</td>
<td>-0.067892</td>
<td>0.316455</td>
<td>0.123915</td>
<td>0.202430</td>
<td>0.193694</td>
<td>-0.098628</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">annual_inc</td>
<td>0.336887</td>
<td>-0.056771</td>
<td>0.330381</td>
<td>1.000000</td>
<td>-0.081685</td>
<td>0.136150</td>
<td>-0.013720</td>
<td>0.299773</td>
<td>0.027871</td>
<td>0.193023</td>
<td>0.236320</td>
<td>-0.050162</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">dti</td>
<td>0.016636</td>
<td>0.079038</td>
<td>0.015786</td>
<td>-0.081685</td>
<td>1.000000</td>
<td>0.136181</td>
<td>-0.017639</td>
<td>0.063571</td>
<td>0.088375</td>
<td>0.102128</td>
<td>-0.025439</td>
<td>-0.014558</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">open_acc</td>
<td>0.198556</td>
<td>0.011649</td>
<td>0.188973</td>
<td>0.136150</td>
<td>0.136181</td>
<td>1.000000</td>
<td>-0.018392</td>
<td>0.221192</td>
<td>-0.131420</td>
<td>0.680728</td>
<td>0.109205</td>
<td>-0.027732</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">pub_rec</td>
<td>-0.077779</td>
<td>0.060986</td>
<td>-0.067892</td>
<td>-0.013720</td>
<td>-0.017639</td>
<td>-0.018392</td>
<td>1.000000</td>
<td>-0.101664</td>
<td>-0.075910</td>
<td>0.019723</td>
<td>0.011552</td>
<td>0.699408</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">revol_bal</td>
<td>0.328320</td>
<td>-0.011280</td>
<td>0.316455</td>
<td>0.299773</td>
<td>0.063571</td>
<td>0.221192</td>
<td>-0.101664</td>
<td>1.000000</td>
<td>0.226346</td>
<td>0.191616</td>
<td>0.194925</td>
<td>-0.124532</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">revol_util</td>
<td>0.099911</td>
<td>0.293659</td>
<td>0.123915</td>
<td>0.027871</td>
<td>0.088375</td>
<td>-0.131420</td>
<td>-0.075910</td>
<td>0.226346</td>
<td>1.000000</td>
<td>-0.104273</td>
<td>0.007514</td>
<td>-0.086751</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">total_acc</td>
<td>0.223886</td>
<td>-0.036404</td>
<td>0.202430</td>
<td>0.193023</td>
<td>0.102128</td>
<td>0.680728</td>
<td>0.019723</td>
<td>0.191616</td>
<td>-0.104273</td>
<td>1.000000</td>
<td>0.381072</td>
<td>0.042035</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mort_acc</td>
<td>0.222315</td>
<td>-0.082583</td>
<td>0.193694</td>
<td>0.236320</td>
<td>-0.025439</td>
<td>0.109205</td>
<td>0.011552</td>
<td>0.194925</td>
<td>0.007514</td>
<td>0.381072</td>
<td>1.000000</td>
<td>0.027239</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">pub_rec_bankruptcies</td>
<td>-0.106539</td>
<td>0.057450</td>
<td>-0.098628</td>
<td>-0.050162</td>
<td>-0.014558</td>
<td>-0.027732</td>
<td>0.699408</td>
<td>-0.124532</td>
<td>-0.086751</td>
<td>0.042035</td>
<td>0.027239</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">7</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(df.corr(numeric_only<span class="op">=</span><span class="va">True</span>),annot<span class="op">=</span><span class="va">True</span>,cmap<span class="op">=</span><span class="st">'viridis'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'installment'</span>,y<span class="op">=</span><span class="st">'loan_amnt'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>&lt;Axes: xlabel='installment', ylabel='loan_amnt'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'loan_status'</span>,y<span class="op">=</span><span class="st">'loan_amnt'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;Axes: xlabel='loan_status', ylabel='loan_amnt'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'loan_status'</span>)[<span class="st">'loan_amnt'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">loan_status</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Charged Off</td>
<td>77673.0</td>
<td>15126.300967</td>
<td>8505.090557</td>
<td>1000.0</td>
<td>8525.0</td>
<td>14000.0</td>
<td>20000.0</td>
<td>40000.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Fully Paid</td>
<td>318357.0</td>
<td>13866.878771</td>
<td>8302.319699</td>
<td>500.0</td>
<td>7500.0</td>
<td>12000.0</td>
<td>19225.0</td>
<td>40000.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'grade'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array(['B', 'A', 'C', 'E', 'D', 'F', 'G'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'sub_grade'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array(['B4', 'B5', 'B3', 'A2', 'C5', 'C3', 'A1', 'B2', 'C1', 'A5', 'E4',
       'A4', 'A3', 'D1', 'C2', 'B1', 'D3', 'D5', 'D2', 'E1', 'E2', 'E5',
       'F4', 'E3', 'D4', 'G1', 'F5', 'G2', 'C4', 'F1', 'F3', 'G5', 'G4',
       'F2', 'G3'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'grade'</span>,hue<span class="op">=</span><span class="st">'loan_status'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;Axes: xlabel='grade', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>subgrade_order <span class="op">=</span> <span class="bu">sorted</span>(df[<span class="st">'sub_grade'</span>].unique())</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'sub_grade'</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>subgrade_order,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span><span class="st">'coolwarm'</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'loan_status'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;Axes: xlabel='sub_grade', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>f_g <span class="op">=</span> df[(df[<span class="st">'grade'</span>] <span class="op">==</span> <span class="st">'G'</span>) <span class="op">|</span> (df[<span class="st">'grade'</span>] <span class="op">==</span> <span class="st">'F'</span>)]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>subgrade_order <span class="op">=</span> <span class="bu">sorted</span>(f_g[<span class="st">'sub_grade'</span>].unique())</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">4</span>))</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>f_g,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'sub_grade'</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>subgrade_order,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span><span class="st">'coolwarm'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'loan_status'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;Axes: xlabel='sub_grade', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="missing-values-and-feature-engineering" class="level1">
<h1>MISSING VALUES AND FEATURE ENGINEERING</h1>
<div class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'loan_repaid'</span>] <span class="op">=</span> (df[<span class="st">'loan_status'</span>] <span class="op">==</span> <span class="st">'Fully Paid'</span>).astype(<span class="bu">int</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'loan_repaid'</span>,<span class="st">'loan_status'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_repaid</th>
<th data-quarto-table-cell-role="th">loan_status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>Charged Off</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396025</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396026</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396027</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396028</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396029</td>
<td>1</td>
<td>Fully Paid</td>
</tr>
</tbody>
</table>

<p>396030 rows × 2 columns</p>
</div>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'loan_repaid'</span>].sort_values().drop(<span class="st">'loan_repaid'</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>loan_amnt                   0
term                        0
int_rate                    0
installment                 0
grade                       0
sub_grade                   0
emp_title               22927
emp_length              18301
home_ownership              0
annual_inc                  0
verification_status         0
issue_d                     0
loan_status                 0
purpose                     0
title                    1756
dti                         0
earliest_cr_line            0
open_acc                    0
pub_rec                     0
revol_bal                   0
revol_util                276
total_acc                   0
initial_list_status         0
application_type            0
mort_acc                37795
pub_rec_bankruptcies      535
address                     0
loan_repaid                 0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> percentage_null(df):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    percentage_missing <span class="op">=</span> (df.isnull().<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(df))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">Percentages of values missing:</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(percentage_missing.<span class="bu">round</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.00
term                    0.00
int_rate                0.00
installment             0.00
grade                   0.00
sub_grade               0.00
emp_title               5.79
emp_length              4.62
home_ownership          0.00
annual_inc              0.00
verification_status     0.00
issue_d                 0.00
loan_status             0.00
purpose                 0.00
title                   0.44
dti                     0.00
earliest_cr_line        0.00
open_acc                0.00
pub_rec                 0.00
revol_bal               0.00
revol_util              0.07
total_acc               0.00
initial_list_status     0.00
application_type        0.00
mort_acc                9.54
pub_rec_bankruptcies    0.14
address                 0.00
loan_repaid             0.00
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'title'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0                        Vacation
1              Debt consolidation
2         Credit card refinancing
3         Credit card refinancing
4           Credit Card Refinance
                   ...           
396025         Debt consolidation
396026         Debt consolidation
396027       pay off credit cards
396028              Loanforpayoff
396029          Toxic Debt Payoff
Name: title, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'purpose'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0                   vacation
1         debt_consolidation
2                credit_card
3                credit_card
4                credit_card
                 ...        
396025    debt_consolidation
396026    debt_consolidation
396027    debt_consolidation
396028    debt_consolidation
396029    debt_consolidation
Name: purpose, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">'title'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="emp_title-and-emp_length" class="level2">
<h2 class="anchored" data-anchor-id="emp_title-and-emp_length"><code>emp_title</code> and <code>emp_length</code></h2>
<div class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'emp_title'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0                        Marketing
1                  Credit analyst 
2                     Statistician
3                  Client Advocate
4          Destiny Management Inc.
                    ...           
396025            licensed bankere
396026                       Agent
396027                City Carrier
396028        Gracon Services, Inc
396029    Internal Revenue Service
Name: emp_title, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'emp_title'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>173105</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">'emp_title'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'emp_length'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0         10+ years
1           4 years
2          &lt; 1 year
3           6 years
4           9 years
            ...    
396025      2 years
396026      5 years
396027    10+ years
396028    10+ years
396029    10+ years
Name: emp_length, Length: 396030, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="29">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>(df[<span class="st">'emp_length'</span>].dropna().unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>['1 year',
 '10+ years',
 '2 years',
 '3 years',
 '4 years',
 '5 years',
 '6 years',
 '7 years',
 '8 years',
 '9 years',
 '&lt; 1 year']</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="30">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ordered_emp_lengths <span class="op">=</span> [<span class="st">'&lt; 1 year'</span>,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'1 year'</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'2 years'</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'3 years'</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a> <span class="st">'4 years'</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a> <span class="st">'5 years'</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a> <span class="st">'6 years'</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'7 years'</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'8 years'</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'9 years'</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'10+ years'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">5</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'emp_length'</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>ordered_emp_lengths,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>              palette<span class="op">=</span><span class="st">'viridis'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>&lt;Axes: xlabel='emp_length', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-33-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="32">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">5</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data<span class="op">=</span>df,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'emp_length'</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>              order<span class="op">=</span>ordered_emp_lengths,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>              hue<span class="op">=</span><span class="st">'loan_repaid'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;Axes: xlabel='emp_length', ylabel='count'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>emp_co <span class="op">=</span> df[df[<span class="st">'loan_repaid'</span>] <span class="op">==</span> <span class="dv">0</span>].groupby(<span class="st">'emp_length'</span>).count()[<span class="st">'loan_repaid'</span>]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>emp_fp <span class="op">=</span> df[df[<span class="st">'loan_repaid'</span>] <span class="op">==</span> <span class="dv">1</span>].groupby(<span class="st">'emp_length'</span>).count()[<span class="st">'loan_repaid'</span>]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">2</span>))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>((emp_co<span class="op">/</span>(emp_fp<span class="op">+</span>emp_co))<span class="op">*</span><span class="dv">100</span>).plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>&lt;Axes: xlabel='emp_length'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-35-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">'emp_length'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filling-mort_acc-using-total_acc" class="level2">
<h2 class="anchored" data-anchor-id="filling-mort_acc-using-total_acc">Filling <code>mort_acc</code> using <code>total_acc</code></h2>
<div class="cell" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.00
term                    0.00
int_rate                0.00
installment             0.00
grade                   0.00
sub_grade               0.00
home_ownership          0.00
annual_inc              0.00
verification_status     0.00
issue_d                 0.00
loan_status             0.00
purpose                 0.00
dti                     0.00
earliest_cr_line        0.00
open_acc                0.00
pub_rec                 0.00
revol_bal               0.00
revol_util              0.07
total_acc               0.00
initial_list_status     0.00
application_type        0.00
mort_acc                9.54
pub_rec_bankruptcies    0.14
address                 0.00
loan_repaid             0.00
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="36">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mort_acc'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>mort_acc
0.0     139777
1.0      60416
2.0      49948
3.0      38049
4.0      27887
5.0      18194
6.0      11069
7.0       6052
8.0       3121
9.0       1656
10.0       865
11.0       479
12.0       264
13.0       146
14.0       107
15.0        61
16.0        37
17.0        22
18.0        18
19.0        15
20.0        13
24.0        10
22.0         7
21.0         4
25.0         4
27.0         3
32.0         2
31.0         2
23.0         2
26.0         2
28.0         1
30.0         1
34.0         1
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df.corr(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'mort_acc'</span>].sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>int_rate               -0.082583
dti                    -0.025439
revol_util              0.007514
pub_rec                 0.011552
pub_rec_bankruptcies    0.027239
loan_repaid             0.073111
open_acc                0.109205
installment             0.193694
revol_bal               0.194925
loan_amnt               0.222315
annual_inc              0.236320
total_acc               0.381072
mort_acc                1.000000
Name: mort_acc, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>total_acc_avgs <span class="op">=</span> df.groupby(<span class="st">'total_acc'</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)[<span class="st">'mort_acc'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_mort_acc(total_acc,mort_acc):</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.isnan(mort_acc):</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> total_acc_avgs[total_acc]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mort_acc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mort_acc'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: fill_mort_acc(x[<span class="st">'total_acc'</span>],x[<span class="st">'mort_acc'</span>]),axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>loan_amnt                 0
term                      0
int_rate                  0
installment               0
grade                     0
sub_grade                 0
home_ownership            0
annual_inc                0
verification_status       0
issue_d                   0
loan_status               0
purpose                   0
dti                       0
earliest_cr_line          0
open_acc                  0
pub_rec                   0
revol_bal                 0
revol_util              276
total_acc                 0
initial_list_status       0
application_type          0
mort_acc                  0
pub_rec_bankruptcies    535
address                   0
loan_repaid               0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="42">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.00
term                    0.00
int_rate                0.00
installment             0.00
grade                   0.00
sub_grade               0.00
home_ownership          0.00
annual_inc              0.00
verification_status     0.00
issue_d                 0.00
loan_status             0.00
purpose                 0.00
dti                     0.00
earliest_cr_line        0.00
open_acc                0.00
pub_rec                 0.00
revol_bal               0.00
revol_util              0.07
total_acc               0.00
initial_list_status     0.00
application_type        0.00
mort_acc                0.00
pub_rec_bankruptcies    0.14
address                 0.00
loan_repaid             0.00
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="43">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>percentage_null(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Percentages of values missing:

loan_amnt               0.0
term                    0.0
int_rate                0.0
installment             0.0
grade                   0.0
sub_grade               0.0
home_ownership          0.0
annual_inc              0.0
verification_status     0.0
issue_d                 0.0
loan_status             0.0
purpose                 0.0
dti                     0.0
earliest_cr_line        0.0
open_acc                0.0
pub_rec                 0.0
revol_bal               0.0
revol_util              0.0
total_acc               0.0
initial_list_status     0.0
application_type        0.0
mort_acc                0.0
pub_rec_bankruptcies    0.0
address                 0.0
loan_repaid             0.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="categorical-features" class="level2">
<h2 class="anchored" data-anchor-id="categorical-features">Categorical Features</h2>
<div class="cell" data-tags="[]" data-execution_count="45">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df.select_dtypes([<span class="st">'object'</span>]).columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>Index(['term', 'grade', 'sub_grade', 'home_ownership', 'verification_status',
       'issue_d', 'loan_status', 'purpose', 'earliest_cr_line',
       'initial_list_status', 'application_type', 'address'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="46">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'term'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>term
 36 months    301247
 60 months     93972
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'term'</span>] <span class="op">=</span> df[<span class="st">'term'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x.split()[<span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="48">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'term'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0         36
1         36
2         36
3         36
4         60
          ..
396025    60
396026    36
396027    36
396028    60
396029    36
Name: term, Length: 395219, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="49">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'zip_code'</span>] <span class="op">=</span> df[<span class="st">'address'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> address: address[<span class="op">-</span><span class="dv">5</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="50">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'zip_code'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>zip_code
70466    56880
22690    56413
30723    56402
48052    55811
00813    45725
29597    45393
05113    45300
11650    11210
93700    11126
86630    10959
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'home_ownership'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>home_ownership
MORTGAGE    198022
RENT        159395
OWN          37660
OTHER          110
NONE            29
ANY              3
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="52">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'home_ownership'</span>] <span class="op">=</span> df[<span class="st">'home_ownership'</span>].replace([<span class="st">'NONE'</span>,<span class="st">'ANY'</span>],<span class="st">'OTHER'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="53">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'home_ownership'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>home_ownership
MORTGAGE    198022
RENT        159395
OWN          37660
OTHER          142
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="54">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>columns_to_1hot <span class="op">=</span> [<span class="st">'home_ownership'</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'verification_status'</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'application_type'</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'initial_list_status'</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'purpose'</span>,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'zip_code'</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'sub_grade'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="55">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.get_dummies(data<span class="op">=</span>df,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>columns_to_1hot,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                    drop_first<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                    dtype<span class="op">=</span><span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="56">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>Index(['loan_amnt', 'term', 'int_rate', 'installment', 'grade', 'annual_inc',
       'issue_d', 'loan_status', 'dti', 'earliest_cr_line', 'open_acc',
       'pub_rec', 'revol_bal', 'revol_util', 'total_acc', 'mort_acc',
       'pub_rec_bankruptcies', 'address', 'loan_repaid',
       'home_ownership_OTHER', 'home_ownership_OWN', 'home_ownership_RENT',
       'verification_status_Source Verified', 'verification_status_Verified',
       'application_type_INDIVIDUAL', 'application_type_JOINT',
       'initial_list_status_w', 'purpose_credit_card',
       'purpose_debt_consolidation', 'purpose_educational',
       'purpose_home_improvement', 'purpose_house', 'purpose_major_purchase',
       'purpose_medical', 'purpose_moving', 'purpose_other',
       'purpose_renewable_energy', 'purpose_small_business',
       'purpose_vacation', 'purpose_wedding', 'zip_code_05113',
       'zip_code_11650', 'zip_code_22690', 'zip_code_29597', 'zip_code_30723',
       'zip_code_48052', 'zip_code_70466', 'zip_code_86630', 'zip_code_93700',
       'sub_grade_A2', 'sub_grade_A3', 'sub_grade_A4', 'sub_grade_A5',
       'sub_grade_B1', 'sub_grade_B2', 'sub_grade_B3', 'sub_grade_B4',
       'sub_grade_B5', 'sub_grade_C1', 'sub_grade_C2', 'sub_grade_C3',
       'sub_grade_C4', 'sub_grade_C5', 'sub_grade_D1', 'sub_grade_D2',
       'sub_grade_D3', 'sub_grade_D4', 'sub_grade_D5', 'sub_grade_E1',
       'sub_grade_E2', 'sub_grade_E3', 'sub_grade_E4', 'sub_grade_E5',
       'sub_grade_F1', 'sub_grade_F2', 'sub_grade_F3', 'sub_grade_F4',
       'sub_grade_F5', 'sub_grade_G1', 'sub_grade_G2', 'sub_grade_G3',
       'sub_grade_G4', 'sub_grade_G5'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="57">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'earliest_cr_line'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>0         Jun-1990
1         Jul-2004
2         Aug-2007
3         Sep-2006
4         Mar-1999
            ...   
396025    Nov-2004
396026    Feb-2006
396027    Mar-1997
396028    Nov-1990
396029    Sep-1998
Name: earliest_cr_line, Length: 395219, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="58">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'earliest_cr_year'</span>] <span class="op">=</span> df[<span class="st">'earliest_cr_line'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">int</span>(x.split(<span class="st">'-'</span>)[<span class="op">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="59">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'earliest_cr_year'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>0         1990
1         2004
2         2007
3         2006
4         1999
          ... 
396025    2004
396026    2006
396027    1997
396028    1990
396029    1998
Name: earliest_cr_year, Length: 395219, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="60">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> [<span class="st">'earliest_cr_line'</span>,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'grade'</span>,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'issue_d'</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'loan_status'</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'address'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="61">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns_to_drop,axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preprocessing" class="level1">
<h1>PREPROCESSING</h1>
<div class="cell" data-tags="[]" data-execution_count="62">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loan_amnt</th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">int_rate</th>
<th data-quarto-table-cell-role="th">installment</th>
<th data-quarto-table-cell-role="th">annual_inc</th>
<th data-quarto-table-cell-role="th">dti</th>
<th data-quarto-table-cell-role="th">open_acc</th>
<th data-quarto-table-cell-role="th">pub_rec</th>
<th data-quarto-table-cell-role="th">revol_bal</th>
<th data-quarto-table-cell-role="th">revol_util</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">sub_grade_F2</th>
<th data-quarto-table-cell-role="th">sub_grade_F3</th>
<th data-quarto-table-cell-role="th">sub_grade_F4</th>
<th data-quarto-table-cell-role="th">sub_grade_F5</th>
<th data-quarto-table-cell-role="th">sub_grade_G1</th>
<th data-quarto-table-cell-role="th">sub_grade_G2</th>
<th data-quarto-table-cell-role="th">sub_grade_G3</th>
<th data-quarto-table-cell-role="th">sub_grade_G4</th>
<th data-quarto-table-cell-role="th">sub_grade_G5</th>
<th data-quarto-table-cell-role="th">earliest_cr_year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10000.0</td>
<td>36</td>
<td>11.44</td>
<td>329.48</td>
<td>117000.0</td>
<td>26.24</td>
<td>16.0</td>
<td>0.0</td>
<td>36369.0</td>
<td>41.8</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1990</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8000.0</td>
<td>36</td>
<td>11.99</td>
<td>265.68</td>
<td>65000.0</td>
<td>22.05</td>
<td>17.0</td>
<td>0.0</td>
<td>20131.0</td>
<td>53.3</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2004</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>15600.0</td>
<td>36</td>
<td>10.49</td>
<td>506.97</td>
<td>43057.0</td>
<td>12.79</td>
<td>13.0</td>
<td>0.0</td>
<td>11987.0</td>
<td>92.2</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7200.0</td>
<td>36</td>
<td>6.49</td>
<td>220.65</td>
<td>54000.0</td>
<td>2.60</td>
<td>6.0</td>
<td>0.0</td>
<td>5472.0</td>
<td>21.5</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2006</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>24375.0</td>
<td>60</td>
<td>17.27</td>
<td>609.33</td>
<td>55000.0</td>
<td>33.95</td>
<td>13.0</td>
<td>0.0</td>
<td>24584.0</td>
<td>69.8</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1999</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396025</td>
<td>10000.0</td>
<td>60</td>
<td>10.99</td>
<td>217.38</td>
<td>40000.0</td>
<td>15.63</td>
<td>6.0</td>
<td>0.0</td>
<td>1990.0</td>
<td>34.3</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2004</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396026</td>
<td>21000.0</td>
<td>36</td>
<td>12.29</td>
<td>700.42</td>
<td>110000.0</td>
<td>21.45</td>
<td>6.0</td>
<td>0.0</td>
<td>43263.0</td>
<td>95.7</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2006</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396027</td>
<td>5000.0</td>
<td>36</td>
<td>9.99</td>
<td>161.32</td>
<td>56500.0</td>
<td>17.56</td>
<td>15.0</td>
<td>0.0</td>
<td>32704.0</td>
<td>66.9</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1997</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">396028</td>
<td>21000.0</td>
<td>60</td>
<td>15.31</td>
<td>503.02</td>
<td>64000.0</td>
<td>15.88</td>
<td>9.0</td>
<td>0.0</td>
<td>15704.0</td>
<td>53.8</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1990</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">396029</td>
<td>2000.0</td>
<td>36</td>
<td>13.61</td>
<td>67.98</td>
<td>42996.0</td>
<td>8.32</td>
<td>3.0</td>
<td>0.0</td>
<td>4292.0</td>
<td>91.3</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1998</td>
</tr>
</tbody>
</table>

<p>395219 rows × 79 columns</p>
</div>
</div>
</div>
<section id="traintestval-split" class="level2">
<h2 class="anchored" data-anchor-id="traintestval-split">TRAIN/TEST/VAL SPLIT</h2>
<div class="cell" data-tags="[]" data-execution_count="63">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'loan_repaid'</span>,axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'loan_repaid'</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="64">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>X_train_temp, X_test, y_train_temp, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">594</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X_train_temp, y_train_temp, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">594</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="65">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training set shape: "</span>, X_train.shape, y_train.shape)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Validation set shape: "</span>, X_val.shape, y_val.shape)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test set shape: "</span>, X_test.shape, y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set shape:  (237131, 78) (237131,)
Validation set shape:  (79044, 78) (79044,)
Test set shape:  (79044, 78) (79044,)</code></pre>
</div>
</div>
</section>
<section id="normalizing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="normalizing-the-data">Normalizing the Data</h2>
<div class="cell" data-tags="[]" data-execution_count="66">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="67">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> scaler.transform(X_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="68">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([[-1.08996185, -0.55794638, -0.78084497, ..., -0.03033429,
        -0.02786656,  0.71431254],
       [-1.08996185,  1.79228692, -0.23107726, ..., -0.03033429,
        -0.02786656,  0.15783544],
       [ 1.89932034,  1.79228692,  2.07973496, ..., -0.03033429,
        -0.02786656, -0.25952238],
       ...,
       [ 0.46446489, -0.55794638,  0.70084605, ..., -0.03033429,
        -0.02786656,  0.01871617],
       [-1.20953314, -0.55794638, -0.2578952 , ..., -0.03033429,
        -0.02786656,  0.57519326],
       [ 1.19683902,  1.79228692,  1.86519147, ..., -0.03033429,
        -0.02786656,  0.85343181]])</code></pre>
</div>
</div>
</section>
</section>
<section id="model-1" class="level1">
<h1>Model 1</h1>
<p>79-&gt;256-&gt;128-&gt;64-&gt;1</p>
<div class="cell" data-tags="[]" data-execution_count="69">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>X_train.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>(237131, 78)</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="101">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">78</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">256</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">128</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">64</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="102">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(),</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.001</span>),</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="103">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>                               patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                               restore_best_weights<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="104">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>model.fit(X_train,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>          y_train,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>          epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>          batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>          validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>          callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/25
927/927 [==============================] - 5s 4ms/step - loss: 0.3407 - val_loss: 0.2714
Epoch 2/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2742 - val_loss: 0.2648
Epoch 3/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2662 - val_loss: 0.2639
Epoch 4/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2630 - val_loss: 0.2617
Epoch 5/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2615 - val_loss: 0.2617
Epoch 6/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2615 - val_loss: 0.2619
Epoch 7/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2602 - val_loss: 0.2609
Epoch 8/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2601 - val_loss: 0.2604
Epoch 9/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2595 - val_loss: 0.2622
Epoch 10/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2593 - val_loss: 0.2622
Epoch 11/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2588 - val_loss: 0.2617
Epoch 12/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2585 - val_loss: 0.2612
Epoch 13/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2584 - val_loss: 0.2603
Epoch 14/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2586 - val_loss: 0.2610
Epoch 15/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2582 - val_loss: 0.2627
Epoch 16/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2578 - val_loss: 0.2593
Epoch 17/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2581 - val_loss: 0.2609
Epoch 18/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2588 - val_loss: 0.2611
Epoch 19/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2577 - val_loss: 0.2608
Epoch 20/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2576 - val_loss: 0.2606
Epoch 21/25
927/927 [==============================] - 4s 4ms/step - loss: 0.2575 - val_loss: 0.2607</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>&lt;keras.src.callbacks.History at 0x2061a6ab750&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="105">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>losses <span class="op">=</span> pd.DataFrame(model.history.history)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>losses.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-76-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="106">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (model.predict(X_val) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,predictions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 791us/step
              precision    recall  f1-score   support

           0       0.99      0.43      0.60     15508
           1       0.88      1.00      0.93     63536

    accuracy                           0.89     79044
   macro avg       0.94      0.71      0.77     79044
weighted avg       0.90      0.89      0.87     79044
</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="107">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_val,predictions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>0.8872526693993219</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="117">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>f1_score(y_val,predictions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>0.9344204391593571</code></pre>
</div>
</div>
</section>
<section id="optuna" class="level1">
<h1>OPTUNA</h1>
<div class="cell" data-tags="[]" data-execution_count="118">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial):</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    n_hidden_layers <span class="op">=</span> trial.suggest_int(<span class="st">'n_hidden_layers'</span>, <span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> trial.suggest_float(<span class="st">'learning_rate'</span>, <span class="fl">1e-5</span>, <span class="fl">1e-1</span>, log<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> trial.suggest_categorical(<span class="st">'batch_size'</span>,[<span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>, <span class="dv">512</span>])</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the model</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">78</span>, input_dim<span class="op">=</span><span class="dv">78</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_hidden_layers):</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>        model.add(Dense(trial.suggest_int(<span class="ss">f'n_units_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, <span class="dv">32</span>, <span class="dv">512</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>        loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(),</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>        optimizer<span class="op">=</span>tf.keras.optimizers.Adam(learning_rate),</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>    early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>                                   patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>                                   restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train,</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>              y_train,</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>              epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>              batch_size<span class="op">=</span>batch_size,</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>              verbose<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>              validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>              callbacks<span class="op">=</span>[early_stopping])</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict on test set</span></span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> (model.predict(X_val) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> accuracy_score(y_val, predictions)</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="113">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>study <span class="op">=</span> optuna.create_study(direction<span class="op">=</span><span class="st">'maximize'</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>study.optimize(objective, n_trials<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[I 2024-02-04 00:51:48,993] A new study created in memory with name: no-name-44202c89-fca0-4c43-95d6-aff126d53523
[I 2024-02-04 00:52:50,670] Trial 0 finished with value: 0.8844947118060826 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.013988119166809553, 'batch_size': 64, 'n_units_1': 133, 'n_units_2': 329, 'n_units_3': 434, 'n_units_4': 49}. Best is trial 0 with value: 0.8844947118060826.
[I 2024-02-04 00:53:37,807] Trial 1 finished with value: 0.886873133950711 and parameters: {'n_hidden_layers': 2, 'learning_rate': 6.768843399144108e-05, 'batch_size': 256, 'n_units_1': 255, 'n_units_2': 52}. Best is trial 1 with value: 0.886873133950711.
[I 2024-02-04 00:54:26,230] Trial 2 finished with value: 0.8866327614999241 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.00013602771275192653, 'batch_size': 128, 'n_units_1': 313}. Best is trial 1 with value: 0.886873133950711.
[I 2024-02-04 00:55:07,282] Trial 3 finished with value: 0.8869743434036739 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0007714572772142803, 'batch_size': 64, 'n_units_1': 241}. Best is trial 3 with value: 0.8869743434036739.
[I 2024-02-04 00:55:52,077] Trial 4 finished with value: 0.8855827134254339 and parameters: {'n_hidden_layers': 4, 'learning_rate': 4.0661280070253036e-05, 'batch_size': 512, 'n_units_1': 38, 'n_units_2': 247, 'n_units_3': 86, 'n_units_4': 307}. Best is trial 3 with value: 0.8869743434036739.
[I 2024-02-04 00:56:33,757] Trial 5 finished with value: 0.8862532260513132 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.01723997939668177, 'batch_size': 256, 'n_units_1': 499, 'n_units_2': 291}. Best is trial 3 with value: 0.8869743434036739.
[I 2024-02-04 00:57:13,478] Trial 6 finished with value: 0.8869363898588128 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.0006765487766536073, 'batch_size': 256, 'n_units_1': 94, 'n_units_2': 510, 'n_units_3': 328}. Best is trial 3 with value: 0.8869743434036739.
[I 2024-02-04 00:58:31,653] Trial 7 finished with value: 0.8877334143008957 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.0031341513877425867, 'batch_size': 256, 'n_units_1': 218, 'n_units_2': 257, 'n_units_3': 314, 'n_units_4': 468, 'n_units_5': 202}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:01:50,018] Trial 8 finished with value: 0.8859116441475634 and parameters: {'n_hidden_layers': 6, 'learning_rate': 2.212668528194164e-05, 'batch_size': 128, 'n_units_1': 396, 'n_units_2': 399, 'n_units_3': 399, 'n_units_4': 396, 'n_units_5': 458, 'n_units_6': 353}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:03:12,118] Trial 9 finished with value: 0.887151459946359 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.001644304650197108, 'batch_size': 256, 'n_units_1': 467, 'n_units_2': 163, 'n_units_3': 456, 'n_units_4': 367, 'n_units_5': 65}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:04:20,396] Trial 10 finished with value: 0.8038054754314053 and parameters: {'n_hidden_layers': 6, 'learning_rate': 0.08788985256614101, 'batch_size': 512, 'n_units_1': 166, 'n_units_2': 137, 'n_units_3': 175, 'n_units_4': 489, 'n_units_5': 213, 'n_units_6': 47}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:05:39,257] Trial 11 finished with value: 0.88718941349122 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.0032121361667814675, 'batch_size': 256, 'n_units_1': 506, 'n_units_2': 186, 'n_units_3': 510, 'n_units_4': 507, 'n_units_5': 37}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:07:05,576] Trial 12 finished with value: 0.8874171347603866 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.003949981099892661, 'batch_size': 256, 'n_units_1': 362, 'n_units_2': 186, 'n_units_3': 271, 'n_units_4': 510, 'n_units_5': 32}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:08:01,116] Trial 13 finished with value: 0.8873159253074238 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.0066606054133530245, 'batch_size': 256, 'n_units_1': 363, 'n_units_2': 48, 'n_units_3': 244, 'n_units_4': 160, 'n_units_5': 221}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:08:59,252] Trial 14 finished with value: 0.8869996457669146 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.0003673903701307182, 'batch_size': 256, 'n_units_1': 199, 'n_units_2': 229, 'n_units_3': 280, 'n_units_4': 435, 'n_units_5': 375}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:09:27,948] Trial 15 finished with value: 0.881686149486362 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.033582890090573324, 'batch_size': 256, 'n_units_1': 317, 'n_units_2': 367, 'n_units_3': 201, 'n_units_4': 218}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:13:41,897] Trial 16 finished with value: 0.8871767623095997 and parameters: {'n_hidden_layers': 6, 'learning_rate': 0.003671931990426043, 'batch_size': 64, 'n_units_1': 422, 'n_units_2': 110, 'n_units_3': 344, 'n_units_4': 509, 'n_units_5': 145, 'n_units_6': 489}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:14:08,856] Trial 17 finished with value: 0.887012296948535 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.0002288149604850374, 'batch_size': 512, 'n_units_1': 321, 'n_units_2': 212, 'n_units_3': 115}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:15:31,448] Trial 18 finished with value: 0.8873412276706645 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.0018314964554035599, 'batch_size': 128, 'n_units_1': 210, 'n_units_2': 283, 'n_units_3': 296, 'n_units_4': 322, 'n_units_5': 355}. Best is trial 7 with value: 0.8877334143008957.
[I 2024-02-04 01:17:48,252] Trial 19 finished with value: 0.8854941551540914 and parameters: {'n_hidden_layers': 6, 'learning_rate': 1.0105013455036976e-05, 'batch_size': 256, 'n_units_1': 274, 'n_units_2': 448, 'n_units_3': 199, 'n_units_4': 441, 'n_units_5': 128, 'n_units_6': 90}. Best is trial 7 with value: 0.8877334143008957.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 940us/step
2471/2471 [==============================] - 2s 699us/step
2471/2471 [==============================] - 2s 705us/step
2471/2471 [==============================] - 2s 742us/step
2471/2471 [==============================] - 2s 807us/step
2471/2471 [==============================] - 2s 913us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 5s 2ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 4s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 886us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 903us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> study.best_params</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best Hyperparameters:"</span>, best_params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="119">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial):</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    n_hidden_layers <span class="op">=</span> trial.suggest_int(<span class="st">'n_hidden_layers'</span>, <span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> trial.suggest_float(<span class="st">'learning_rate'</span>, <span class="fl">1e-5</span>, <span class="fl">1e-1</span>, log<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    batch_size <span class="op">=</span> trial.suggest_categorical(<span class="st">'batch_size'</span>,[<span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>, <span class="dv">512</span>])</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the model</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">78</span>, input_dim<span class="op">=</span><span class="dv">78</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_hidden_layers):</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>        model.add(Dense(trial.suggest_int(<span class="ss">f'n_units_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, <span class="dv">32</span>, <span class="dv">512</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>        loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(),</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>        optimizer<span class="op">=</span>tf.keras.optimizers.Adam(learning_rate),</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>    early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>                                   patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>                                   restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train,</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>              y_train,</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>              epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>              batch_size<span class="op">=</span>batch_size,</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>              verbose<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>              validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>              callbacks<span class="op">=</span>[early_stopping])</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict on test set</span></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> (model.predict(X_val) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> f1_score(y_val, predictions)</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="120">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>study <span class="op">=</span> optuna.create_study(direction<span class="op">=</span><span class="st">'maximize'</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>study.optimize(objective, n_trials<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[I 2024-02-04 01:18:37,906] A new study created in memory with name: no-name-79cab9c9-8d51-4a57-9c1e-7ec5623d792c
[I 2024-02-04 01:19:48,544] Trial 0 finished with value: 0.932227018242271 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.00010517975239290712, 'batch_size': 128, 'n_units_1': 158, 'n_units_2': 447, 'n_units_3': 63}. Best is trial 0 with value: 0.932227018242271.
[I 2024-02-04 01:22:03,619] Trial 1 finished with value: 0.9337158700857742 and parameters: {'n_hidden_layers': 5, 'learning_rate': 2.0045670608061688e-05, 'batch_size': 128, 'n_units_1': 254, 'n_units_2': 210, 'n_units_3': 286, 'n_units_4': 87, 'n_units_5': 356}. Best is trial 1 with value: 0.9337158700857742.
[I 2024-02-04 01:25:47,187] Trial 2 finished with value: 0.9327951594080087 and parameters: {'n_hidden_layers': 6, 'learning_rate': 1.1479904716614894e-05, 'batch_size': 128, 'n_units_1': 425, 'n_units_2': 371, 'n_units_3': 367, 'n_units_4': 200, 'n_units_5': 319, 'n_units_6': 273}. Best is trial 1 with value: 0.9337158700857742.
[I 2024-02-04 01:26:11,850] Trial 3 finished with value: 0.9340769361979842 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0005432532744150325, 'batch_size': 128, 'n_units_1': 61}. Best is trial 3 with value: 0.9340769361979842.
[I 2024-02-04 01:26:53,587] Trial 4 finished with value: 0.9339785792219939 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.0004711392334284392, 'batch_size': 128, 'n_units_1': 182, 'n_units_2': 198, 'n_units_3': 67}. Best is trial 3 with value: 0.9340769361979842.
[I 2024-02-04 01:27:33,916] Trial 5 finished with value: 0.933709051435709 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0003945596580423886, 'batch_size': 128, 'n_units_1': 410}. Best is trial 3 with value: 0.9340769361979842.
[I 2024-02-04 01:28:30,535] Trial 6 finished with value: 0.9341351150705272 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.0010872221889587782, 'batch_size': 64, 'n_units_1': 71, 'n_units_2': 247}. Best is trial 6 with value: 0.9341351150705272.
[I 2024-02-04 01:28:58,946] Trial 7 finished with value: 0.9330971238015839 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.00010130080124660437, 'batch_size': 512, 'n_units_1': 194}. Best is trial 6 with value: 0.9341351150705272.
[I 2024-02-04 01:29:41,749] Trial 8 finished with value: 0.934028521420606 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.00016374244187262636, 'batch_size': 256, 'n_units_1': 329, 'n_units_2': 437, 'n_units_3': 174, 'n_units_4': 217}. Best is trial 6 with value: 0.9341351150705272.
[I 2024-02-04 01:30:52,228] Trial 9 finished with value: 0.934405703595681 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.0031408618138749427, 'batch_size': 64, 'n_units_1': 61, 'n_units_2': 347, 'n_units_3': 78}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:32:24,388] Trial 10 finished with value: 0.8912329920044887 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.021481221143387942, 'batch_size': 64, 'n_units_1': 510, 'n_units_2': 37, 'n_units_3': 511, 'n_units_4': 510}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:33:48,570] Trial 11 finished with value: 0.9343206077507453 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.004477684505671628, 'batch_size': 64, 'n_units_1': 45, 'n_units_2': 314}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:34:38,731] Trial 12 finished with value: 0.9342705055436284 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.006714250568280603, 'batch_size': 64, 'n_units_1': 38, 'n_units_2': 340}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:36:00,110] Trial 13 finished with value: 0.934310436164577 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.004203256607470885, 'batch_size': 64, 'n_units_1': 124, 'n_units_2': 336}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:37:13,762] Trial 14 finished with value: 0.8912329920044887 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.051870924111533843, 'batch_size': 64, 'n_units_1': 108, 'n_units_2': 279, 'n_units_3': 188}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:37:42,521] Trial 15 finished with value: 0.9336905559276624 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.0028761274305599076, 'batch_size': 256, 'n_units_1': 260, 'n_units_2': 135}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:38:54,704] Trial 16 finished with value: 0.9319952739183106 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.014826539383811255, 'batch_size': 512, 'n_units_1': 119, 'n_units_2': 501, 'n_units_3': 162, 'n_units_4': 474}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:41:29,130] Trial 17 finished with value: 0.8912329920044887 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.09850320509420289, 'batch_size': 64, 'n_units_1': 37, 'n_units_2': 389, 'n_units_3': 377, 'n_units_4': 335, 'n_units_5': 50}. Best is trial 9 with value: 0.934405703595681.
[I 2024-02-04 01:42:53,620] Trial 18 finished with value: 0.9344323827046918 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.0022033812153185147, 'batch_size': 64, 'n_units_1': 319, 'n_units_2': 289, 'n_units_3': 34}. Best is trial 18 with value: 0.9344323827046918.
[I 2024-02-04 01:44:33,468] Trial 19 finished with value: 0.9343358988373982 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.002107303493710252, 'batch_size': 64, 'n_units_1': 328, 'n_units_2': 147, 'n_units_3': 60, 'n_units_4': 37, 'n_units_5': 494}. Best is trial 18 with value: 0.9344323827046918.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 860us/step
2471/2471 [==============================] - 2s 954us/step
2471/2471 [==============================] - 4s 2ms/step
2471/2471 [==============================] - 2s 681us/step
2471/2471 [==============================] - 2s 740us/step
2471/2471 [==============================] - 2s 712us/step
2471/2471 [==============================] - 2s 716us/step
2471/2471 [==============================] - 2s 687us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 783us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 733us/step
2471/2471 [==============================] - 2s 718us/step
2471/2471 [==============================] - 2s 726us/step
2471/2471 [==============================] - 2s 837us/step
2471/2471 [==============================] - 2s 773us/step
2471/2471 [==============================] - 3s 997us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 830us/step
2471/2471 [==============================] - 2s 926us/step</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="121">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">78</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">64</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">32</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>model.add(Dropout(<span class="fl">0.5</span>))</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>,activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="122">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span>tf.keras.losses.BinaryCrossentropy(),</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.001</span>),</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="123">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>early_stopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">'val_loss'</span>,</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>                               patience<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>                               restore_best_weights<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="124">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>model.fit(X_train,</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>          y_train,</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>          epochs<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>          batch_size<span class="op">=</span><span class="dv">256</span>,</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>          validation_data<span class="op">=</span>(X_val,y_val),</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>          callbacks<span class="op">=</span>[early_stopping])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/25
927/927 [==============================] - 3s 2ms/step - loss: 0.3780 - val_loss: 0.2725
Epoch 2/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2814 - val_loss: 0.2664
Epoch 3/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2704 - val_loss: 0.2637
Epoch 4/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2665 - val_loss: 0.2627
Epoch 5/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2638 - val_loss: 0.2626
Epoch 6/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2626 - val_loss: 0.2628
Epoch 7/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2615 - val_loss: 0.2619
Epoch 8/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2610 - val_loss: 0.2620
Epoch 9/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2606 - val_loss: 0.2619
Epoch 10/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2605 - val_loss: 0.2617
Epoch 11/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2596 - val_loss: 0.2617
Epoch 12/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2598 - val_loss: 0.2613
Epoch 13/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2598 - val_loss: 0.2605
Epoch 14/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2593 - val_loss: 0.2611
Epoch 15/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2591 - val_loss: 0.2604
Epoch 16/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2587 - val_loss: 0.2605
Epoch 17/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2590 - val_loss: 0.2595
Epoch 18/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2583 - val_loss: 0.2600
Epoch 19/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2584 - val_loss: 0.2591
Epoch 20/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2578 - val_loss: 0.2597
Epoch 21/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2583 - val_loss: 0.2593
Epoch 22/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2579 - val_loss: 0.2597
Epoch 23/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2578 - val_loss: 0.2594
Epoch 24/25
927/927 [==============================] - 2s 2ms/step - loss: 0.2577 - val_loss: 0.2597</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>&lt;keras.src.callbacks.History at 0x2071a1e4690&gt;</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="125">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (model.predict(X_val) <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="st">"int32"</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>f1_score(y_val,predictions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 709us/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>0.9343913552347793</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="126">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>study <span class="op">=</span> optuna.create_study(direction<span class="op">=</span><span class="st">'maximize'</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>study.optimize(objective, n_trials<span class="op">=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[I 2024-02-04 02:11:29,425] A new study created in memory with name: no-name-1ec853fc-eb36-4d01-8e41-697965d16d08
[I 2024-02-04 02:12:12,172] Trial 0 finished with value: 0.933769928287797 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.00540423900513375, 'batch_size': 64, 'n_units_1': 365}. Best is trial 0 with value: 0.933769928287797.
[I 2024-02-04 02:13:03,338] Trial 1 finished with value: 0.9335189697180647 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.00012525037580485532, 'batch_size': 512, 'n_units_1': 115, 'n_units_2': 174, 'n_units_3': 510, 'n_units_4': 157}. Best is trial 0 with value: 0.933769928287797.
[I 2024-02-04 02:14:56,015] Trial 2 finished with value: 0.93312853390321 and parameters: {'n_hidden_layers': 5, 'learning_rate': 2.295660438997666e-05, 'batch_size': 128, 'n_units_1': 112, 'n_units_2': 187, 'n_units_3': 443, 'n_units_4': 168, 'n_units_5': 435}. Best is trial 0 with value: 0.933769928287797.
[I 2024-02-04 02:16:06,874] Trial 3 finished with value: 0.9330975713043932 and parameters: {'n_hidden_layers': 3, 'learning_rate': 4.027421291628526e-05, 'batch_size': 256, 'n_units_1': 291, 'n_units_2': 206, 'n_units_3': 265}. Best is trial 0 with value: 0.933769928287797.
[I 2024-02-04 02:17:11,195] Trial 4 finished with value: 0.9341194113236397 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.009747229567375386, 'batch_size': 128, 'n_units_1': 374, 'n_units_2': 172, 'n_units_3': 447}. Best is trial 4 with value: 0.9341194113236397.
[I 2024-02-04 02:18:17,880] Trial 5 finished with value: 0.9340003394057448 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.009535400326069761, 'batch_size': 128, 'n_units_1': 317, 'n_units_2': 37, 'n_units_3': 376, 'n_units_4': 471}. Best is trial 4 with value: 0.9341194113236397.
[I 2024-02-04 02:18:44,220] Trial 6 finished with value: 0.932453752283951 and parameters: {'n_hidden_layers': 5, 'learning_rate': 0.021247649491079514, 'batch_size': 512, 'n_units_1': 160, 'n_units_2': 424, 'n_units_3': 154, 'n_units_4': 90, 'n_units_5': 437}. Best is trial 4 with value: 0.9341194113236397.
[I 2024-02-04 02:19:31,704] Trial 7 finished with value: 0.9335978252883697 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.022129322442718785, 'batch_size': 512, 'n_units_1': 363, 'n_units_2': 351, 'n_units_3': 70}. Best is trial 4 with value: 0.9341194113236397.
[I 2024-02-04 02:20:06,679] Trial 8 finished with value: 0.9333969956293385 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.08489577307608316, 'batch_size': 512, 'n_units_1': 282, 'n_units_2': 352, 'n_units_3': 404}. Best is trial 4 with value: 0.9341194113236397.
[I 2024-02-04 02:20:53,581] Trial 9 finished with value: 0.933913644417324 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.013856425506278884, 'batch_size': 128, 'n_units_1': 289, 'n_units_2': 113, 'n_units_3': 418, 'n_units_4': 247}. Best is trial 4 with value: 0.9341194113236397.
[I 2024-02-04 02:21:16,423] Trial 10 finished with value: 0.9342896225368775 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0008830823832065983, 'batch_size': 256, 'n_units_1': 497}. Best is trial 10 with value: 0.9342896225368775.
[I 2024-02-04 02:21:38,470] Trial 11 finished with value: 0.9339218833600856 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0010402342228447389, 'batch_size': 256, 'n_units_1': 512}. Best is trial 10 with value: 0.9342896225368775.
[I 2024-02-04 02:22:15,603] Trial 12 finished with value: 0.9339670910668338 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.0012752591858375974, 'batch_size': 256, 'n_units_1': 501, 'n_units_2': 276}. Best is trial 10 with value: 0.9342896225368775.
[I 2024-02-04 02:26:36,911] Trial 13 finished with value: 0.9340935646566387 and parameters: {'n_hidden_layers': 6, 'learning_rate': 0.00023826042569366168, 'batch_size': 64, 'n_units_1': 431, 'n_units_2': 494, 'n_units_3': 266, 'n_units_4': 497, 'n_units_5': 36, 'n_units_6': 81}. Best is trial 10 with value: 0.9342896225368775.
[I 2024-02-04 02:26:57,787] Trial 14 finished with value: 0.9338773213280811 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.0019803578336312325, 'batch_size': 256, 'n_units_1': 437, 'n_units_2': 32}. Best is trial 10 with value: 0.9342896225368775.
[I 2024-02-04 02:27:44,837] Trial 15 finished with value: 0.9330734436376621 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.0001655330530209092, 'batch_size': 128, 'n_units_1': 202, 'n_units_2': 277}. Best is trial 10 with value: 0.9342896225368775.
[I 2024-02-04 02:28:13,006] Trial 16 finished with value: 0.9343198415279544 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.003515526590181167, 'batch_size': 256, 'n_units_1': 445}. Best is trial 16 with value: 0.9343198415279544.
[I 2024-02-04 02:28:31,753] Trial 17 finished with value: 0.9339817052378764 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.00042793437327702386, 'batch_size': 256, 'n_units_1': 38}. Best is trial 16 with value: 0.9343198415279544.
[I 2024-02-04 02:28:56,132] Trial 18 finished with value: 0.934207796057507 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.003259755593815917, 'batch_size': 256, 'n_units_1': 441}. Best is trial 16 with value: 0.9343198415279544.
[I 2024-02-04 02:29:46,923] Trial 19 finished with value: 0.934364190048192 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.00037199871057345024, 'batch_size': 256, 'n_units_1': 469, 'n_units_2': 509}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:30:47,741] Trial 20 finished with value: 0.9336605329102474 and parameters: {'n_hidden_layers': 2, 'learning_rate': 7.28396204065813e-05, 'batch_size': 256, 'n_units_1': 222, 'n_units_2': 495}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:31:16,116] Trial 21 finished with value: 0.9334383498536208 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0004632379777267988, 'batch_size': 256, 'n_units_1': 479}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:31:57,096] Trial 22 finished with value: 0.9337426679421296 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.000552734886603334, 'batch_size': 256, 'n_units_1': 407, 'n_units_2': 409}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:32:21,681] Trial 23 finished with value: 0.9338831350543016 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.002719289280041049, 'batch_size': 256, 'n_units_1': 468}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:33:56,556] Trial 24 finished with value: 0.9341235637512703 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.0006985360843290117, 'batch_size': 64, 'n_units_1': 398, 'n_units_2': 409}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:34:19,456] Trial 25 finished with value: 0.9343221279808163 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.0048247220408027, 'batch_size': 256, 'n_units_1': 468}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:34:50,205] Trial 26 finished with value: 0.9327343727061863 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.05422427863269155, 'batch_size': 256, 'n_units_1': 333, 'n_units_2': 311}. Best is trial 19 with value: 0.934364190048192.
[I 2024-02-04 02:35:15,135] Trial 27 finished with value: 0.9344685509701376 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.005149822749150912, 'batch_size': 256, 'n_units_1': 460}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:35:42,671] Trial 28 finished with value: 0.933202112267456 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.034210668048031544, 'batch_size': 256, 'n_units_1': 463, 'n_units_2': 454}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:36:20,624] Trial 29 finished with value: 0.9341380911321882 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.005721799145122851, 'batch_size': 64, 'n_units_1': 394}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:37:12,750] Trial 30 finished with value: 0.9344282932103108 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.007017175861066562, 'batch_size': 64, 'n_units_1': 344}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:38:05,557] Trial 31 finished with value: 0.9342573349407214 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.004143245312769183, 'batch_size': 64, 'n_units_1': 362}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:39:04,330] Trial 32 finished with value: 0.9341321799922979 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.001472787621465948, 'batch_size': 64, 'n_units_1': 415}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:39:54,624] Trial 33 finished with value: 0.9343823854081006 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.006340039940519293, 'batch_size': 64, 'n_units_1': 471}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:41:29,283] Trial 34 finished with value: 0.9342361616562637 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.00832823435328622, 'batch_size': 64, 'n_units_1': 338, 'n_units_2': 347}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:42:26,846] Trial 35 finished with value: 0.9336370315944159 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.014861111841849368, 'batch_size': 64, 'n_units_1': 248, 'n_units_2': 512, 'n_units_3': 36}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:44:33,350] Trial 36 finished with value: 0.9339622641509434 and parameters: {'n_hidden_layers': 1, 'learning_rate': 1.9431285003316707e-05, 'batch_size': 64, 'n_units_1': 388}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:45:51,995] Trial 37 finished with value: 0.933951126060903 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.00030849490896252973, 'batch_size': 64, 'n_units_1': 482, 'n_units_2': 225}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:49:53,500] Trial 38 finished with value: 0.9336791788638974 and parameters: {'n_hidden_layers': 5, 'learning_rate': 1.1543048898600676e-05, 'batch_size': 64, 'n_units_1': 323, 'n_units_2': 122, 'n_units_3': 188, 'n_units_4': 336, 'n_units_5': 116}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:51:16,036] Trial 39 finished with value: 0.9330479884673117 and parameters: {'n_hidden_layers': 3, 'learning_rate': 6.270533889913161e-05, 'batch_size': 512, 'n_units_1': 359, 'n_units_2': 448, 'n_units_3': 326}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:53:27,495] Trial 40 finished with value: 0.9342891278375149 and parameters: {'n_hidden_layers': 6, 'learning_rate': 0.002065668206685641, 'batch_size': 128, 'n_units_1': 417, 'n_units_2': 385, 'n_units_3': 154, 'n_units_4': 348, 'n_units_5': 242, 'n_units_6': 441}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:53:44,147] Trial 41 finished with value: 0.934189786207458 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.009914713869198954, 'batch_size': 256, 'n_units_1': 459}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:54:05,232] Trial 42 finished with value: 0.9343453398137258 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.00596371828451976, 'batch_size': 512, 'n_units_1': 481}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:54:35,743] Trial 43 finished with value: 0.9338369845597584 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.02020597605379281, 'batch_size': 512, 'n_units_1': 512}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:54:55,891] Trial 44 finished with value: 0.9337387277421455 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.006030567735642017, 'batch_size': 512, 'n_units_1': 485}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:55:23,069] Trial 45 finished with value: 0.933378399229961 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.03406814024160296, 'batch_size': 512, 'n_units_1': 427, 'n_units_2': 312}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:55:49,687] Trial 46 finished with value: 0.9333204195970914 and parameters: {'n_hidden_layers': 4, 'learning_rate': 0.007736184522691625, 'batch_size': 512, 'n_units_1': 307, 'n_units_2': 81, 'n_units_3': 327, 'n_units_4': 48}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:56:12,511] Trial 47 finished with value: 0.9339433842949076 and parameters: {'n_hidden_layers': 1, 'learning_rate': 0.013127472549476995, 'batch_size': 512, 'n_units_1': 451}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:57:59,646] Trial 48 finished with value: 0.9343226771525264 and parameters: {'n_hidden_layers': 2, 'learning_rate': 0.001711150595923881, 'batch_size': 64, 'n_units_1': 495, 'n_units_2': 238}. Best is trial 27 with value: 0.9344685509701376.
[I 2024-02-04 02:59:16,986] Trial 49 finished with value: 0.9341159576909127 and parameters: {'n_hidden_layers': 3, 'learning_rate': 0.0008882728102786101, 'batch_size': 128, 'n_units_1': 146, 'n_units_2': 464, 'n_units_3': 500}. Best is trial 27 with value: 0.9344685509701376.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2471/2471 [==============================] - 2s 713us/step
2471/2471 [==============================] - 2s 979us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 935us/step
2471/2471 [==============================] - 2s 941us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 2s 706us/step
2471/2471 [==============================] - 2s 706us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 4s 2ms/step
2471/2471 [==============================] - 2s 699us/step
2471/2471 [==============================] - 2s 772us/step
2471/2471 [==============================] - 2s 694us/step
2471/2471 [==============================] - 2s 688us/step
2471/2471 [==============================] - 2s 682us/step
2471/2471 [==============================] - 2s 957us/step
2471/2471 [==============================] - 2s 780us/step
2471/2471 [==============================] - 2s 695us/step
2471/2471 [==============================] - 2s 896us/step
2471/2471 [==============================] - 2s 689us/step
2471/2471 [==============================] - 2s 913us/step
2471/2471 [==============================] - 2s 688us/step
2471/2471 [==============================] - 2s 810us/step
2471/2471 [==============================] - 2s 690us/step
2471/2471 [==============================] - 2s 924us/step
2471/2471 [==============================] - 2s 687us/step
2471/2471 [==============================] - 2s 698us/step
2471/2471 [==============================] - 2s 687us/step
2471/2471 [==============================] - 2s 687us/step
2471/2471 [==============================] - 2s 684us/step
2471/2471 [==============================] - 2s 848us/step
2471/2471 [==============================] - 2s 827us/step
2471/2471 [==============================] - 2s 694us/step
2471/2471 [==============================] - 2s 895us/step
2471/2471 [==============================] - 4s 991us/step
2471/2471 [==============================] - 3s 1ms/step
2471/2471 [==============================] - 4s 1ms/step
2471/2471 [==============================] - 2s 680us/step
2471/2471 [==============================] - 2s 685us/step
2471/2471 [==============================] - 2s 684us/step
2471/2471 [==============================] - 2s 692us/step
2471/2471 [==============================] - 2s 866us/step
2471/2471 [==============================] - 2s 789us/step
2471/2471 [==============================] - 2s 673us/step
2471/2471 [==============================] - 2s 904us/step
2471/2471 [==============================] - 3s 1ms/step</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>